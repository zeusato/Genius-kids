import{r as w,j as e,H as v,w as g,y as f,I as d,D as N,X as C,u as k,a as I}from"./index-kvI97k6j.js";import{M as R}from"./MusicControls-9szBTmx4.js";import{A as L}from"./arrow-left-nyKTrqkZ.js";import{L as z}from"./lock-CVADT2uE.js";import"./volume-x-BkcTN7TK.js";const A=({student:r,onBack:c})=>{var p;const n=v(),[a,u]=w.useState(null),j=async t=>{try{const m=await(await fetch(t.imagePath)).blob(),i=window.URL.createObjectURL(m),s=document.createElement("a");s.href=i,s.download=`${t.name}.jpg`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(i)}catch(o){console.error("Download failed:",o),alert("KhÃ´ng thá»ƒ táº£i áº£nh. Vui lÃ²ng thá»­ láº¡i!")}};return e.jsxs("div",{className:"min-h-screen p-4 pb-20 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all",children:[e.jsx(L,{size:20}),e.jsx("span",{children:"Quay láº¡i"})]}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"ðŸ“š Album sÆ°u táº­p"}),e.jsx(R,{})]}),e.jsx("div",{className:"space-y-8",children:n.map(t=>{const o=t.images.length,m=t.images.filter(s=>r.ownedImageIds.includes(s.id)).length,i=Math.round(m/o*100);return e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:t.name}),e.jsx("p",{className:"text-gray-600",children:t.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-black text-brand-600",children:[m,"/",o]}),e.jsx("div",{className:"text-sm text-gray-500",children:"ÄÃ£ sÆ°u táº­p"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-brand-500 to-brand-600 h-full transition-all duration-500 rounded-full",style:{width:`${i}%`}})}),e.jsxs("p",{className:"text-sm text-center mt-1 text-gray-600",children:[i,"% hoÃ n thÃ nh"]})]}),e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3",children:t.images.map(s=>{const l=r.ownedImageIds.includes(s.id),x=g(s.rarity),b=f(s.rarity);return e.jsx("div",{className:`relative aspect-square rounded-xl overflow-hidden transition-all border-4 ${l?"shadow-md hover:scale-105 cursor-pointer":"bg-gray-100"}`,style:{borderColor:x},onClick:()=>l&&u(s),children:l?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:s.imagePath,alt:s.name,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 py-1 text-center text-xs font-bold text-white",style:{backgroundColor:x+"E6"},children:b})]}):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gradient-to-br from-gray-100 to-gray-200",children:[e.jsx(z,{size:28,className:"text-gray-400 mb-2"}),e.jsx("span",{className:"text-xs text-gray-500 font-semibold",children:"ChÆ°a má»Ÿ"})]})},s.id)})}),e.jsx("div",{className:"mt-6 pt-4 border-t flex flex-wrap gap-3 justify-center text-sm",children:[d.Common,d.Uncommon,d.Rare,d.Epic,d.Legendary].map(s=>{const l=g(s),x=f(s),b=t.images.filter(h=>h.rarity===s&&r.ownedImageIds.includes(h.id)).length,y=t.images.filter(h=>h.rarity===s).length;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2",style:{backgroundColor:l,borderColor:l}}),e.jsxs("span",{className:"font-semibold text-gray-700",children:[x,":"]}),e.jsxs("span",{className:"font-bold",style:{color:l},children:[b,"/",y]})]},s)})})]},t.id)})}),n.length===0&&e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-2xl text-gray-400",children:"ChÆ°a cÃ³ bá»™ sÆ°u táº­p nÃ o"})}),a&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4 backdrop-blur-sm",onClick:()=>u(null),children:e.jsxs("div",{className:"relative max-w-4xl bg-white rounded-3xl overflow-hidden shadow-2xl flex flex-col animate-in zoom-in-95 fade-in duration-300 border-8",style:{borderColor:g(a.rarity)},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"absolute top-4 right-4 z-10 flex gap-2",children:[e.jsx("button",{onClick:()=>j(a),className:"p-3 bg-brand-500 hover:bg-brand-600 text-white rounded-full transition-all shadow-lg hover:shadow-xl hover:scale-110 flex items-center gap-2",title:"Táº£i áº£nh vá»",children:e.jsx(N,{size:24})}),e.jsx("button",{onClick:()=>u(null),className:"p-3 bg-white/90 hover:bg-white text-gray-800 rounded-full transition-all shadow-lg hover:shadow-xl hover:scale-110",children:e.jsx(C,{size:24})})]}),e.jsx("div",{className:"relative bg-gradient-to-br from-gray-50 to-gray-100 p-4",children:e.jsx("img",{src:a.imagePath,alt:a.name,className:"w-full object-contain max-h-[65vh] rounded-xl shadow-lg"})}),e.jsxs("div",{className:"p-8 bg-gradient-to-br from-white via-gray-50 to-gray-100",children:[e.jsx("div",{className:"flex items-center gap-3 mb-4",children:e.jsxs("div",{className:"px-4 py-2 rounded-full font-bold text-white shadow-lg flex items-center gap-2",style:{backgroundColor:g(a.rarity)},children:[e.jsx("span",{className:"text-lg",children:"âœ¨"}),e.jsx("span",{className:"text-sm uppercase tracking-wider",children:f(a.rarity)})]})}),e.jsx("h3",{className:"text-3xl font-extrabold text-gray-900 mb-2 drop-shadow-sm",children:a.name}),e.jsxs("p",{className:"text-gray-600 font-medium",children:["Bá»™ sÆ°u táº­p: ",e.jsx("span",{className:"text-brand-600 font-semibold",children:((p=n.find(t=>t.id===a.collectionId))==null?void 0:p.name)||"Unknown"})]})]})]})})]})};function B(){const r=k(),{currentStudent:c}=I();if(!c)return r("/"),null;const n=()=>{r("/profile")};return e.jsx(A,{student:c,onBack:n})}export{B as AlbumPage};
