import{j as e,r as m,S as ue,u as Ae}from"./index-RrRYS0T7.js";import{M as Se}from"./MusicControls-D6SiE3a6.js";import{Z as pe}from"./zap-CAQ_WV2m.js";import{Z as Me,U as ze,R as $e,C as oe}from"./zap-off-B4mK88hE.js";import{T as Ie}from"./trash-2-BYUMTL_T.js";import{A as Le}from"./arrow-right-CSS2FD0f.js";import{A as me}from"./arrow-left-DRBxDdfV.js";import{B as Be}from"./book-open-B-489VF6.js";import{G as Te}from"./gamepad-2-CdjWVRlU.js";import"./volume-x-CVsLNvFd.js";const ge={battery:{type:"battery",name:"Pin",icon:"üîã",description:"Ngu·ªìn ƒëi·ªán cung c·∫•p nƒÉng l∆∞·ª£ng cho m·∫°ch",hasInput:!0,hasOutput:!0,isSource:!0,isLoad:!1,isPassive:!1},bulb:{type:"bulb",name:"ƒê√®n",icon:"üí°",description:"Ph√°t s√°ng khi c√≥ d√≤ng ƒëi·ªán ch·∫°y qua",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1},switch:{type:"switch",name:"C√¥ng t·∫Øc",icon:"üîò",description:"ƒê√≥ng/m·ªü m·∫°ch ƒëi·ªán, click ƒë·ªÉ b·∫≠t/t·∫Øt",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!1,isPassive:!0},wire:{type:"wire",name:"D√¢y d·∫´n",icon:"üìè",description:"K·∫øt n·ªëi c√°c linh ki·ªán v·ªõi nhau",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!1,isPassive:!0},bell:{type:"bell",name:"Chu√¥ng",icon:"üîî",description:"Rung v√† ph√°t ti·∫øng k√™u khi c√≥ ƒëi·ªán",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1},fan:{type:"fan",name:"Qu·∫°t",icon:"üåÄ",description:"Quay t·∫°o gi√≥ khi c√≥ ƒëi·ªán, c√≥ th·ªÉ th·ªïi t·∫Øt n·∫øn",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1},candle:{type:"candle",name:"N·∫øn",icon:"üïØÔ∏è",description:"Ng·ªçn n·∫øn ƒëang ch√°y, t·∫Øt khi c√≥ gi√≥ t·ª´ qu·∫°t",hasInput:!1,hasOutput:!1,isSource:!1,isLoad:!1,isPassive:!0},buzzer:{type:"buzzer",name:"C√≤i",icon:"üì¢",description:"Ph√°t √¢m thanh b√°o ƒë·ªông khi c√≥ ƒëi·ªán",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1}},te=[{id:1,title:"D√≤ng ƒëi·ªán l√† g√¨?",subtitle:"Hi·ªÉu v·ªÅ electron v√† s·ª± di chuy·ªÉn c·ªßa ch√∫ng",theory:{content:"D√≤ng ƒëi·ªán l√† s·ª± di chuy·ªÉn c·ªßa c√°c h·∫°t electron qua d√¢y d·∫´n. Gi·ªëng nh∆∞ n∆∞·ªõc ch·∫£y trong ·ªëng, electron ch·∫£y trong d√¢y ƒë·ªìng khi c√≥ ngu·ªìn ƒëi·ªán.",keyPoints:["Electron l√† h·∫°t r·∫•t nh·ªè mang ƒëi·ªán √¢m (-)","Khi electron di chuy·ªÉn ‚Üí t·∫°o ra d√≤ng ƒëi·ªán","C·∫ßn c√≥ ngu·ªìn (pin) ƒë·ªÉ ƒë·∫©y electron ƒëi"]},illustration:{type:"animation",data:{showElectronFlow:!0}},exercise:{type:"quiz",instruction:"D√≤ng ƒëi·ªán l√† g√¨?",correctAnswer:"electron-movement"}},{id:2,title:"M·∫°ch k√≠n v√† m·∫°ch h·ªü",subtitle:"T·∫°i sao ƒë√®n ph·∫£i trong m·∫°ch k√≠n m·ªõi s√°ng?",theory:{content:"M·∫°ch k√≠n l√† khi c√°c linh ki·ªán n·ªëi th√†nh v√≤ng tr√≤n li√™n t·ª•c. M·∫°ch h·ªü l√† khi c√≥ ch·ªó b·ªã ƒë·ª©t. Electron ch·ªâ ch·∫°y ƒë∆∞·ª£c trong m·∫°ch k√≠n!",keyPoints:["M·∫°ch k√≠n = v√≤ng li√™n t·ª•c t·ª´ (+) v·ªÅ (-) c·ªßa pin","M·∫°ch h·ªü = c√≥ ch·ªó ƒë·ª©t, electron kh√¥ng ch·∫°y ƒë∆∞·ª£c","ƒê√®n ch·ªâ s√°ng khi ·ªü trong m·∫°ch k√≠n"]},illustration:{type:"comparison",data:{showClosed:!0,showOpen:!0}},exercise:{type:"fix",instruction:"K√©o th√™m d√¢y ƒë·ªÉ n·ªëi m·∫°ch h·ªü th√†nh m·∫°ch k√≠n"}},{id:3,title:"Ngu·ªìn ƒëi·ªán - Pin",subtitle:"C·ª±c (+) v√† c·ª±c (-) c·ªßa pin",theory:{content:"Pin c√≥ 2 c·ª±c: c·ª±c d∆∞∆°ng (+) v√† c·ª±c √¢m (-). Pin ƒë·∫©y electron t·ª´ c·ª±c (-) ƒëi v√≤ng qua m·∫°ch r·ªìi v·ªÅ c·ª±c (+). Ph·∫£i n·ªëi ƒë√∫ng chi·ªÅu pin m·ªõi ho·∫°t ƒë·ªông!",keyPoints:["Pin c√≥ 2 ƒë·∫ßu: (+) d∆∞∆°ng v√† (-) √¢m","Electron ƒëi t·ª´ (-) ‚Üí qua m·∫°ch ‚Üí v·ªÅ (+)","Pin cung c·∫•p nƒÉng l∆∞·ª£ng cho d√≤ng ƒëi·ªán ch·∫°y"]},illustration:{type:"diagram",data:{showBatteryPoles:!0}},exercise:{type:"build",instruction:"ƒê·∫∑t pin v√†o ƒë√∫ng v·ªã tr√≠ ƒë·ªÉ ƒë√®n s√°ng"}},{id:4,title:"C√¥ng t·∫Øc ƒëi·ªán",subtitle:"ƒê√≥ng/m·ªü m·∫°ch m·ªôt c√°ch an to√†n",theory:{content:"C√¥ng t·∫Øc gi√∫p ƒë√≥ng ho·∫∑c m·ªü m·∫°ch ƒëi·ªán. Khi b·∫≠t = m·∫°ch k√≠n = ƒë√®n s√°ng. Khi t·∫Øt = m·∫°ch h·ªü = ƒë√®n t·∫Øt. D√πng c√¥ng t·∫Øc an to√†n h∆°n r√∫t d√¢y!",keyPoints:["C√¥ng t·∫Øc B·∫¨T = m·∫°ch k√≠n = c√≥ d√≤ng ƒëi·ªán","C√¥ng t·∫Øc T·∫ÆT = m·∫°ch h·ªü = kh√¥ng c√≥ d√≤ng ƒëi·ªán","Lu√¥n d√πng c√¥ng t·∫Øc ƒë·ªÉ b·∫≠t/t·∫Øt thi·∫øt b·ªã ƒëi·ªán"]},illustration:{type:"animation",data:{showSwitchToggle:!0}},exercise:{type:"build",instruction:"Th√™m c√¥ng t·∫Øc v√†o m·∫°ch ƒë·ªÉ ƒëi·ªÅu khi·ªÉn ƒë√®n"}},{id:5,title:"L·∫Øp m·∫°ch ƒë∆°n gi·∫£n",subtitle:"Pin + D√¢y + ƒê√®n = √Ånh s√°ng!",theory:{content:"M·∫°ch ƒëi·ªán ƒë∆°n gi·∫£n nh·∫•t g·ªìm: Pin (ngu·ªìn), D√¢y d·∫´n (ƒë∆∞·ªùng ƒëi), ƒê√®n (t·∫£i). N·ªëi ch√∫ng th√†nh v√≤ng k√≠n v√† ƒë√®n s·∫Ω s√°ng!",keyPoints:["Ngu·ªìn: Pin cung c·∫•p nƒÉng l∆∞·ª£ng","D√¢y d·∫´n: ƒê∆∞·ªùng cho electron ch·∫°y","T·∫£i: ƒê√®n bi·∫øn ƒëi·ªán th√†nh √°nh s√°ng"]},illustration:{type:"diagram",data:{showSimpleCircuit:!0}},exercise:{type:"build",instruction:"T·ª± l·∫Øp m·∫°ch ho√†n ch·ªânh: Pin ‚Üí D√¢y ‚Üí ƒê√®n ‚Üí D√¢y ‚Üí Pin"}},{id:6,title:"M·∫°ch n·ªëi ti·∫øp",subtitle:"C√°c linh ki·ªán x·∫øp th√†nh 1 h√†ng",theory:{content:"M·∫°ch n·ªëi ti·∫øp: c√°c linh ki·ªán n·ªëi th√†nh M·ªòT ƒë∆∞·ªùng duy nh·∫•t. N·∫øu 1 ƒë√®n t·∫Øt ‚Üí c·∫£ m·∫°ch m·∫•t ƒëi·ªán ‚Üí t·∫•t c·∫£ ƒë√®n t·∫Øt!",keyPoints:["C√°c linh ki·ªán n·ªëi th√†nh 1 ƒë∆∞·ªùng","1 ƒë√®n h·ªèng = c·∫£ d√£y t·∫Øt","C√†ng nhi·ªÅu ƒë√®n ‚Üí m·ªói ƒë√®n c√†ng m·ªù"]},illustration:{type:"diagram",data:{showSeriesCircuit:!0}},exercise:{type:"build",instruction:"L·∫Øp 2 b√≥ng ƒë√®n N·ªêI TI·∫æP v·ªõi nhau"}},{id:7,title:"M·∫°ch song song",subtitle:"M·ªói linh ki·ªán c√≥ ƒë∆∞·ªùng ri√™ng",theory:{content:"M·∫°ch song song: m·ªói linh ki·ªán c√≥ NH√ÅNH RI√äNG n·ªëi v·ªõi pin. N·∫øu 1 ƒë√®n t·∫Øt ‚Üí c√°c ƒë√®n kh√°c v·∫´n s√°ng b√¨nh th∆∞·ªùng!",keyPoints:["M·ªói ƒë√®n c√≥ ƒë∆∞·ªùng ri√™ng ƒë·∫øn pin","1 ƒë√®n h·ªèng ‚â† ·∫£nh h∆∞·ªüng ƒë√®n kh√°c","C√°c ƒë√®n s√°ng ƒë·ªÅu nh∆∞ nhau"]},illustration:{type:"diagram",data:{showParallelCircuit:!0}},exercise:{type:"build",instruction:"L·∫Øp 2 b√≥ng ƒë√®n SONG SONG v·ªõi nhau"}},{id:8,title:"So s√°nh v√† ·ª©ng d·ª•ng",subtitle:"Khi n√†o d√πng n·ªëi ti·∫øp, khi n√†o d√πng song song?",theory:{content:"N·ªëi ti·∫øp: ƒë∆°n gi·∫£n, ti·∫øt ki·ªám d√¢y, nh∆∞ng 1 h·ªèng = t·∫•t c·∫£ h·ªèng. Song song: ph·ª©c t·∫°p h∆°n, t·ªën d√¢y, nh∆∞ng an to√†n v√† ƒë√®n s√°ng ƒë·ªÅu.",keyPoints:["ƒê√®n trang tr√≠ th∆∞·ªùng N·ªêI TI·∫æP","ƒê√®n trong nh√† th∆∞·ªùng SONG SONG","Ch·ªçn lo·∫°i m·∫°ch ph√π h·ª£p v·ªõi m·ª•c ƒë√≠ch"]},illustration:{type:"comparison",data:{compareSeries:!0,compareParallel:!0}},exercise:{type:"quiz",instruction:"Nh√† b·∫°n n√™n d√πng m·∫°ch g√¨ ƒë·ªÉ khi 1 ƒë√®n h·ªèng, c√°c ƒë√®n kh√°c v·∫´n s√°ng?",correctAnswer:"parallel"}}],qe=[{id:"e1",difficulty:1,title:"Th·∫Øp s√°ng ƒë√®n",description:"L·∫Øp m·∫°ch ƒë∆°n gi·∫£n ƒë·ªÉ l√†m ƒë√®n s√°ng",hint:"C·∫ßn: Pin + ƒê√®n, n·ªëi d√¢y gi·ªØa ch√∫ng",requiredComponents:["battery","bulb"],validator:"validateBulbOn"},{id:"e2",difficulty:1,title:"Th√™m c√¥ng t·∫Øc",description:"L·∫Øp m·∫°ch c√≥ c√¥ng t·∫Øc ƒë·ªÉ b·∫≠t/t·∫Øt ƒë√®n",hint:"Th√™m c√¥ng t·∫Øc v√†o gi·ªØa m·∫°ch",requiredComponents:["battery","bulb","switch"],validator:"validateSwitchControls"},{id:"e3",difficulty:1,title:"Chu√¥ng c·ª≠a",description:"L·∫Øp chu√¥ng c√≥ th·ªÉ b·∫•m ƒë·ªÉ k√™u",hint:"D√πng c√¥ng t·∫Øc nh∆∞ n√∫t b·∫•m",requiredComponents:["battery","bell","switch"],validator:"validateBellWorks"},{id:"m1",difficulty:2,title:"Hai ƒë√®n n·ªëi ti·∫øp",description:"L·∫Øp 2 ƒë√®n n·ªëi ti·∫øp v·ªõi 1 c√¥ng t·∫Øc ƒëi·ªÅu khi·ªÉn c·∫£ 2",hint:"C√°c ƒë√®n n·ªëi th√†nh 1 h√†ng",requiredComponents:["battery","bulb","bulb","switch"],validator:"validateSeriesBulbs"},{id:"m2",difficulty:2,title:"Hai ƒë√®n song song",description:"L·∫Øp 2 ƒë√®n song song",hint:"M·ªói ƒë√®n c·∫ßn c√≥ ƒë∆∞·ªùng ri√™ng",requiredComponents:["battery","bulb","bulb"],validator:"validateParallelBulbs"},{id:"m3",difficulty:2,title:"Qu·∫°t th√¥ng gi√≥",description:"L·∫Øp qu·∫°t c√≥ c√¥ng t·∫Øc ƒëi·ªÅu khi·ªÉn",hint:"Gi·ªëng m·∫°ch ƒë√®n, thay ƒë√®n b·∫±ng qu·∫°t",requiredComponents:["battery","fan","switch"],validator:"validateFanWorks"},{id:"m4",difficulty:2,title:"Th·ªïi t·∫Øt n·∫øn",description:"D√πng qu·∫°t ƒëi·ªán ƒë·ªÉ th·ªïi t·∫Øt n·∫øn ƒëang ch√°y",hint:"ƒê·∫∑t qu·∫°t g·∫ßn n·∫øn, b·∫≠t qu·∫°t ƒë·ªÉ t·∫°o gi√≥",requiredComponents:["battery","fan","switch","candle"],validator:"validateCandleBlown"},{id:"h1",difficulty:3,title:"ƒêi·ªÅu khi·ªÉn ƒë·ªôc l·∫≠p",description:"L·∫Øp 2 ƒë√®n, m·ªói ƒë√®n c√≥ c√¥ng t·∫Øc ri√™ng",hint:"M·ªói ƒë√®n 1 nh√°nh v·ªõi 1 c√¥ng t·∫Øc",requiredComponents:["battery","bulb","bulb","switch","switch"],validator:"validateIndependentControl"},{id:"h2",difficulty:3,title:"H·ªá th·ªëng b√°o ƒë·ªông",description:"L·∫Øp chu√¥ng V√Ä c√≤i c√πng k√™u khi b·∫≠t c√¥ng t·∫Øc",hint:"Chu√¥ng v√† c√≤i n·ªëi song song",requiredComponents:["battery","bell","buzzer","switch"],validator:"validateAlarmSystem"},{id:"h3",difficulty:3,title:"Ph√≤ng th√¥ng minh",description:"ƒê√®n s√°ng + qu·∫°t quay, ƒëi·ªÅu khi·ªÉn ri√™ng bi·ªát",hint:"ƒê√®n v√† qu·∫°t m·ªói c√°i 1 c√¥ng t·∫Øc ri√™ng",requiredComponents:["battery","bulb","fan","switch","switch"],validator:"validateSmartRoom"},{id:"e4",difficulty:1,title:"C√≤i b√°o hi·ªáu",description:"L·∫Øp c√≤i ƒë∆°n gi·∫£n v·ªõi pin",hint:"N·ªëi c√≤i v√†o pin qua d√¢y d·∫´n",requiredComponents:["battery","buzzer"],validator:"validateBuzzerWorks"},{id:"e5",difficulty:1,title:"Qu·∫°t mini",description:"L·∫Øp qu·∫°t ch·∫°y b·∫±ng pin",hint:"N·ªëi pin v·ªõi qu·∫°t",requiredComponents:["battery","fan"],validator:"validateFanWorks"},{id:"m5",difficulty:2,title:"ƒê√®n v√† chu√¥ng",description:"L·∫Øp ƒë√®n V√Ä chu√¥ng c√πng ho·∫°t ƒë·ªông",hint:"N·ªëi song song ƒë√®n v√† chu√¥ng",requiredComponents:["battery","bulb","bell","switch"],validator:"validateBulbAndBell"},{id:"m6",difficulty:2,title:"Ba ƒë√®n n·ªëi ti·∫øp",description:"L·∫Øp 3 ƒë√®n n·ªëi ti·∫øp c√πng s√°ng",hint:"N·ªëi 3 ƒë√®n th√†nh 1 chu·ªói",requiredComponents:["battery","bulb","bulb","bulb"],validator:"validateThreeBulbsSeries"},{id:"h4",difficulty:3,title:"M·∫°ch ph·ª©c h·ª£p",description:"L·∫Øp ƒë√®n, qu·∫°t, chu√¥ng c√πng ho·∫°t ƒë·ªông v·ªõi c√¥ng t·∫Øc t·ªïng",hint:"N·ªëi t·∫•t c·∫£ song song r·ªìi th√™m c√¥ng t·∫Øc t·ªïng",requiredComponents:["battery","bulb","fan","bell","switch"],validator:"validateComplexCircuit"}];function Ee(n){let t=qe;return t[Math.floor(Math.random()*t.length)]}const De=({component:n,isSelected:t,isConnecting:c,onClick:r,onToggle:l,onPortClick:o,onDragStart:f,isDragging:x})=>{const y=ge[n.type],h=n.isActive,B=n.type==="switch"?n.state:null,E=(()=>{switch(n.type){case"battery":return{bg:"bg-gradient-to-r from-red-500 to-slate-600",glow:h?"shadow-red-500/50":""};case"bulb":return{bg:h?"bg-yellow-400":"bg-slate-600",glow:h?"shadow-yellow-400/80 shadow-lg":""};case"switch":return{bg:B==="on"?"bg-green-500":"bg-slate-600",glow:B==="on"?"shadow-green-500/50":""};case"bell":return{bg:h?"bg-yellow-500":"bg-slate-600",glow:h?"shadow-yellow-500/50":""};case"fan":return{bg:h?"bg-cyan-500":"bg-slate-600",glow:h?"shadow-cyan-500/50":""};case"candle":return{bg:n.isActive?"bg-slate-500":"bg-orange-400",glow:n.isActive?"":"shadow-orange-400/50"};case"buzzer":return{bg:h?"bg-purple-500":"bg-slate-600",glow:h?"shadow-purple-500/50":""};default:return{bg:"bg-slate-600",glow:""}}})(),N=p=>{p.stopPropagation(),n.type==="switch"&&l?l():r()},O=(p,A)=>{p.stopPropagation(),o==null||o(A)},W=p=>{p.target.closest(".port-button")||f==null||f(p)};return e.jsxs("div",{className:`
                absolute w-16 h-16 rounded-xl
                flex flex-col items-center justify-center
                transition-all duration-200
                ${E.bg} ${E.glow}
                ${t?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-slate-900":""}
                ${c?"ring-2 ring-cyan-400 animate-pulse":""}
                ${x?"cursor-grabbing scale-105 opacity-80":"cursor-grab"}
                hover:scale-105
            `,style:{left:n.x,top:n.y,transform:`rotate(${n.rotation}deg)`,zIndex:x?100:1},onClick:N,onMouseDown:W,children:[e.jsx("span",{className:`text-2xl select-none ${n.type==="fan"&&h?"animate-spin":""}`,children:y.icon}),n.type==="switch"&&e.jsx("span",{className:"text-[10px] text-white font-semibold mt-0.5 select-none",children:B==="on"?"B·∫¨T":"T·∫ÆT"}),n.type==="candle"&&!n.isActive&&e.jsx("div",{className:"absolute -top-2 text-sm animate-pulse select-none",children:"üî•"}),y.hasInput&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"port-button absolute -left-3 top-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-blue-500 border-2 border-white hover:scale-125 hover:bg-blue-400 transition-all z-10",onClick:p=>O(p,"input"),title:"ƒê·∫ßu v√†o (‚àí)"}),n.type==="battery"&&e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-[55%] text-lg font-bold text-white select-none pointer-events-none drop-shadow-md",children:"‚àí"})]}),y.hasOutput&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"port-button absolute -right-3 top-1/2 -translate-y-1/2 w-5 h-5 rounded-full bg-red-500 border-2 border-white hover:scale-125 hover:bg-red-400 transition-all z-10",onClick:p=>O(p,"output"),title:"ƒê·∫ßu ra (+)"}),n.type==="battery"&&e.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-[55%] text-lg font-bold text-white select-none pointer-events-none drop-shadow-md",children:"+"})]})]})},Oe=({onDragStart:n,disabled:t})=>{const c=["battery","bulb","switch","bell","fan","candle","buzzer"];return e.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-slate-800/50 rounded-xl border border-white/10",children:[e.jsx("h3",{className:"text-white/70 text-xs font-semibold uppercase tracking-wider mb-1",children:"Linh ki·ªán"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:c.map(r=>{const l=ge[r];return e.jsxs("button",{draggable:!t,onDragStart:o=>{o.dataTransfer.setData("componentType",r),n(r)},disabled:t,className:`
                                flex flex-col items-center justify-center p-2 rounded-lg
                                bg-slate-700/50 border border-white/10
                                hover:bg-slate-600/50 hover:border-cyan-500/50
                                transition-all cursor-grab active:cursor-grabbing
                                ${t?"opacity-50 cursor-not-allowed":""}
                            `,title:l.description,children:[e.jsx("span",{className:"text-2xl mb-1",children:l.icon}),e.jsx("span",{className:"text-white/70 text-[10px] text-center leading-tight",children:l.name})]},r)})}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-white/10",children:[e.jsx("p",{className:"text-white/40 text-[10px] text-center",children:"K√©o th·∫£ v√†o canvas"}),e.jsx("p",{className:"text-cyan-400/60 text-[10px] text-center mt-1",children:"üí° Nh·∫•n v√†o ƒë·∫ßu n·ªëi ƒë·ªÉ t·∫°o d√¢y"})]})]})};let Re=0,We=0;const re=({initialCircuit:n,onChange:t,onCircuitStatusChange:c,readOnly:r=!1,hideToolbar:l=!1})=>{const[o,f]=m.useState((n==null?void 0:n.components)||[]),[x,y]=m.useState((n==null?void 0:n.wires)||[]),[h,B]=m.useState(null),[D,E]=m.useState(!1),[N,O]=m.useState(!1),[W,p]=m.useState(new Map),[A,F]=m.useState([]),[S,G]=m.useState(null),[H,V]=m.useState(null),[Y,Z]=m.useState({x:0,y:0}),[T,M]=m.useState(null),I=m.useRef(null);m.useEffect(()=>{t==null||t({components:o,wires:x})},[o,x]),m.useEffect(()=>{c==null||c({isComplete:D,isPowered:N})},[D,N,c]);const R=()=>{F(s=>[...s.slice(-19),{components:[...o],wires:[...x]}])},le=()=>{if(A.length===0)return;const s=A[A.length-1];f(s.components),y(s.wires),F(i=>i.slice(0,-1)),t==null||t({components:s.components,wires:s.wires})},_=m.useCallback(s=>{s.preventDefault();const i=s.dataTransfer.getData("componentType");if(!i||i==="wire")return;const a=s.currentTarget.getBoundingClientRect(),b=s.clientX-a.left-32,w=s.clientY-a.top-32;R();const z={id:`comp_${++Re}`,type:i,x:Math.max(0,Math.min(b,a.width-64)),y:Math.max(0,Math.min(w,a.height-64)),rotation:0,state:i==="switch"?"off":"on",isActive:!1},k=[...o,z];f(k),t==null||t({components:k,wires:x})},[o,x,t]),U=s=>{s.preventDefault(),s.dataTransfer.dropEffect="copy"},L=(s,i)=>{const a=o.find(w=>w.id===s);if(!a||r||!I.current)return;const b=I.current.getBoundingClientRect();V(s),Z({x:i.clientX-b.left-a.x,y:i.clientY-b.top-a.y}),R()},K=s=>{if(!H||!I.current)return;const i=I.current.getBoundingClientRect(),a=s.clientX-i.left-Y.x,b=s.clientY-i.top-Y.y;f(w=>w.map(z=>z.id===H?{...z,x:Math.max(0,Math.min(a,i.width-64)),y:Math.max(0,Math.min(b,i.height-64))}:z))},ae=()=>{H&&(V(null),t==null||t({components:o,wires:x}))},be=(s,i)=>{if(!r)if(!S)G({id:s,port:i});else{if(S.id!==s){R();const a={id:`wire_${++We}`,fromId:S.id,fromPort:S.port,toId:s,toPort:i},b=[...x,a];y(b),t==null||t({components:o,wires:b}),N&&J(o,b)}G(null)}},xe=s=>{R();const i=o.map(a=>a.id===s?{...a,state:a.state==="on"?"off":"on"}:a);f(i),t==null||t({components:i,wires:x}),N&&J(i,x)},fe=()=>{R(),f([]),y([]),B(null),G(null),E(!1),O(!1),t==null||t({components:[],wires:[]})},ye=s=>{if(r)return;R();const i=x.filter(a=>a.id!==s);y(i),M(null),t==null||t({components:o,wires:i}),N&&J(o,i)},ve=(s,i)=>{const a=s.find(d=>d.type==="battery");if(!a)return{activeIds:new Set,wireAnalysis:new Map};const b=new Map;s.forEach(d=>b.set(d.id,[])),i.forEach(d=>{var v,u;(v=b.get(d.fromId))==null||v.push({id:d.toId,wireId:d.id,myPort:d.fromPort,otherPort:d.toPort}),(u=b.get(d.toId))==null||u.push({id:d.fromId,wireId:d.id,myPort:d.toPort,otherPort:d.fromPort})});const w=new Map,z=[a.id];w.set(a.id,0);let k=0;for(;k<z.length;){const d=z[k++],v=b.get(d)||[];for(const u of v){if(d===a.id&&u.myPort!=="input")continue;const P=u.id,$=s.find(q=>q.id===P);($==null?void 0:$.type)==="switch"&&$.state==="off"||w.has(P)||(w.set(P,w.get(d)+1),z.push(P))}}const C=new Map,j=[a.id];for(C.set(a.id,0),k=0;k<j.length;){const d=j[k++],v=b.get(d)||[];for(const u of v){if(d===a.id&&u.myPort!=="output")continue;const P=u.id,$=s.find(q=>q.id===P);($==null?void 0:$.type)==="switch"&&$.state==="off"||C.has(P)||(C.set(P,C.get(d)+1),j.push(P))}}const g=new Set;s.forEach(d=>{d.type!=="battery"&&w.has(d.id)&&C.has(d.id)&&g.add(d.id)}),Array.from(g).some(d=>{const v=s.find(u=>u.id===d);return v&&["bulb","bell","fan","buzzer"].includes(v.type)})&&g.add(a.id);const X=new Map;return i.forEach(d=>{const v=d.fromId,u=d.toId,P=g.has(v),$=g.has(u);if(P&&$){let q=!1;const ne=s.find(Q=>Q.id===v),se=s.find(Q=>Q.id===u),je=(ne==null?void 0:ne.type)==="battery",Ne=(se==null?void 0:se.type)==="battery";if(je)d.fromPort==="input"?q=!1:d.fromPort==="output"&&(q=!0);else if(Ne)d.toPort==="input"?q=!0:d.toPort==="output"&&(q=!1);else{const Q=w.get(v)??9999,ke=C.get(v)??9999,de=Q-ke,Pe=w.get(u)??9999,Ce=C.get(u)??9999,he=Pe-Ce;de<he?q=!1:de>he&&(q=!0)}X.set(d.id,{isActive:!0,isReverse:q})}else X.set(d.id,{isActive:!1,isReverse:!1})}),{activeIds:g,wireAnalysis:X}},J=(s,i,a)=>{if(!(a??N)){E(!1),f(s.map(g=>({...g,isActive:!1}))),p(new Map);return}const{activeIds:w,wireAnalysis:z}=ve(s,i),k=s.map(g=>({...g,isActive:w.has(g.id)})),C=k.some(g=>["bulb","bell","fan","buzzer"].includes(g.type)&&g.isActive);E(C);const j=k.find(g=>g.type==="fan"&&g.isActive);j&&k.forEach(g=>{g.type==="candle"&&Math.sqrt(Math.pow(j.x-g.x,2)+Math.pow(j.y-g.y,2))<150&&(g.isActive=!0)}),f(k),p(z)},we=()=>{const s=!N;O(s),J(o,x,s)},ce=(s,i)=>{const a=o.find(b=>b.id===s);return a?{x:a.x+(i==="input"?0:64),y:a.y+32}:{x:0,y:0}};return e.jsxs("div",{className:"flex gap-4 h-full",children:[!r&&!l&&e.jsx("div",{className:"w-32 flex-shrink-0",children:e.jsx(Oe,{onDragStart:()=>{},disabled:!1})}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-sky-100 to-blue-100 rounded-lg px-4 py-2 border border-sky-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:we,className:`
                                flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-all shadow-md
                                ${N?"bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg shadow-green-400/30":"bg-gray-100 text-gray-600 hover:bg-gray-200 border border-gray-300"}
                            `,children:[N?e.jsx(pe,{size:18}):e.jsx(Me,{size:18}),N?"ƒêang ch·∫°y ‚ö°":"B·∫≠t ngu·ªìn"]}),e.jsx("span",{className:`text-sm px-3 py-1 rounded-full font-medium ${D?"bg-green-100 text-green-700 border border-green-300":"bg-red-100 text-red-700 border border-red-300"}`,children:D?"‚úì M·∫°ch k√≠n":"‚úó M·∫°ch h·ªü"}),S&&e.jsx("span",{className:"text-sm px-3 py-1 rounded-full bg-cyan-100 text-cyan-700 border border-cyan-300 animate-pulse font-medium",children:"üîó ƒêang n·ªëi d√¢y..."})]}),!r&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:le,disabled:A.length===0,className:"flex items-center gap-1 p-2 rounded-lg bg-white text-gray-600 hover:bg-gray-100 border border-gray-300 disabled:opacity-50 transition-all",title:"Ho√†n t√°c",children:e.jsx(ze,{size:18})}),e.jsx("button",{onClick:fe,className:"flex items-center gap-1 p-2 rounded-lg bg-white text-gray-600 hover:bg-red-100 hover:text-red-600 border border-gray-300 hover:border-red-300 transition-all",title:"X√≥a t·∫•t c·∫£",children:e.jsx(Ie,{size:18})})]})]}),e.jsxs("div",{ref:I,className:`
                        relative flex-1 min-h-[400px] bg-gradient-to-br from-sky-50 via-blue-50 to-indigo-50 rounded-xl border-2
                        ${S?"border-cyan-400 shadow-lg shadow-cyan-200/50":"border-blue-200"} 
                        overflow-hidden cursor-${H?"grabbing":"default"}
                    `,onDrop:_,onDragOver:U,onMouseMove:K,onMouseUp:ae,onMouseLeave:ae,onClick:()=>{B(null),G(null)},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsx("svg",{className:"absolute inset-0 w-full h-full",style:{pointerEvents:"none"},children:x.map(s=>{const i=ce(s.fromId,s.fromPort),a=ce(s.toId,s.toPort),b=W.get(s.id),w=(b==null?void 0:b.isActive)??!1,z=(b==null?void 0:b.isReverse)??!1,k=a.x-i.x;a.y-i.y;const C=25;let j;if(s.fromPort==="output"&&s.toPort==="input"){const u=i.x+Math.max(C,Math.abs(k)/2);j=`${i.x},${i.y} ${u},${i.y} ${u},${a.y} ${a.x},${a.y}`}else if(s.fromPort==="input"&&s.toPort==="output"){const u=i.x-Math.max(C,Math.abs(k)/2);j=`${i.x},${i.y} ${u},${i.y} ${u},${a.y} ${a.x},${a.y}`}else if(s.fromPort==="output"&&s.toPort==="output"){const u=Math.max(i.x,a.x)+C;j=`${i.x},${i.y} ${u},${i.y} ${u},${a.y} ${a.x},${a.y}`}else{const u=Math.min(i.x,a.x)-C;j=`${i.x},${i.y} ${u},${i.y} ${u},${a.y} ${a.x},${a.y}`}const g=j.split(" ").map(u=>{const[P,$]=u.split(",").map(Number);return{x:P,y:$}}),ee=(g[1].x+g[2].x)/2,X=(g[1].y+g[2].y)/2;let d;z?d=`M${j.split(" ").reverse().join(" ").split(" ").map(P=>P.replace(","," ")).join(" L ")}`:d=`M${j.split(" ").map(u=>u.replace(","," ")).join(" L ")}`;const v=T===s.id;return e.jsxs("g",{onMouseEnter:()=>M(s.id),onMouseLeave:()=>M(null),style:{cursor:"pointer",pointerEvents:"auto"},children:[e.jsx("polyline",{points:j,fill:"none",stroke:"transparent",strokeWidth:15,style:{pointerEvents:"stroke"}}),e.jsx("polyline",{points:j,fill:"none",stroke:v?"#ef4444":w?"#22d3ee":"#64748b",strokeWidth:v?4:3,strokeLinecap:"round",strokeLinejoin:"round",style:{pointerEvents:"none"}}),w&&!v&&e.jsx("circle",{r:"4",fill:"#22d3ee",children:e.jsx("animateMotion",{dur:"1.5s",repeatCount:"indefinite",path:d})}),v&&!r&&e.jsxs("g",{onClick:u=>{u.stopPropagation(),ye(s.id)},style:{cursor:"pointer"},children:[e.jsx("circle",{cx:ee,cy:X,r:12,fill:"#ef4444",stroke:"white",strokeWidth:2}),e.jsx("text",{x:ee,y:X+1,textAnchor:"middle",dominantBaseline:"middle",fill:"white",fontSize:"14",fontWeight:"bold",children:"√ó"})]})]},s.id)})}),o.map(s=>e.jsx(De,{component:s,isSelected:h===s.id,isConnecting:(S==null?void 0:S.id)===s.id,onClick:()=>B(s.id),onToggle:()=>xe(s.id),onPortClick:i=>be(s.id,i),onDragStart:i=>L(s.id,i),isDragging:H===s.id},s.id)),o.length===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white/30",children:[e.jsx("p",{className:"text-lg mb-2",children:"K√©o th·∫£ linh ki·ªán v√†o ƒë√¢y"}),e.jsx("p",{className:"text-sm",children:"Nh·∫•n v√†o ƒë·∫ßu xanh/ƒë·ªè ƒë·ªÉ n·ªëi d√¢y"})]})})]})]})]})},ie={validateBasicCircuit:(n,t)=>t.isPowered&&t.isComplete,validateBulbOn:(n,t)=>{const c=n.components.find(r=>r.type==="bulb"&&r.isActive);return t.isPowered&&t.isComplete&&!!c},validateSwitchControls:(n,t)=>{const c=n.components.find(l=>l.type==="bulb"&&l.isActive),r=n.components.some(l=>l.type==="switch");return t.isPowered&&t.isComplete&&!!c&&r},validateBellWorks:(n,t)=>{const c=n.components.find(r=>r.type==="bell"&&r.isActive);return t.isPowered&&t.isComplete&&!!c},validateSeriesBulbs:(n,t)=>{const c=n.components.filter(r=>r.type==="bulb"&&r.isActive);return t.isPowered&&t.isComplete&&c.length>=2},validateParallelBulbs:(n,t)=>{const c=n.components.filter(r=>r.type==="bulb"&&r.isActive);return t.isPowered&&t.isComplete&&c.length>=2},validateFanWorks:(n,t)=>{const c=n.components.find(r=>r.type==="fan"&&r.isActive);return t.isPowered&&t.isComplete&&!!c},validateCandleBlown:(n,t)=>{const c=n.components.find(l=>l.type==="candle"&&l.isActive),r=n.components.find(l=>l.type==="fan"&&l.isActive);return t.isPowered&&!!r&&!!c},validateIndependentControl:(n,t)=>{const c=n.components.filter(l=>l.type==="bulb"),r=n.components.filter(l=>l.type==="switch");return c.length<2||r.length<2?!1:t.isPowered&&c.some(l=>l.isActive)},validateAlarmSystem:(n,t)=>{const c=n.components.find(l=>l.type==="bell"&&l.isActive),r=n.components.find(l=>l.type==="buzzer"&&l.isActive);return t.isPowered&&!!c&&!!r},validateSmartRoom:(n,t)=>{const c=n.components.find(o=>o.type==="bulb"&&o.isActive),r=n.components.find(o=>o.type==="fan"&&o.isActive),l=n.components.filter(o=>o.type==="switch");return t.isPowered&&!!c&&!!r&&l.length>=2},validateBuzzerWorks:(n,t)=>{const c=n.components.find(r=>r.type==="buzzer"&&r.isActive);return t.isPowered&&t.isComplete&&!!c},validateBulbAndBell:(n,t)=>{const c=n.components.find(l=>l.type==="bulb"&&l.isActive),r=n.components.find(l=>l.type==="bell"&&l.isActive);return t.isPowered&&!!c&&!!r},validateThreeBulbsSeries:(n,t)=>{const c=n.components.filter(r=>r.type==="bulb"&&r.isActive);return t.isPowered&&t.isComplete&&c.length>=3},validateComplexCircuit:(n,t)=>{const c=n.components.find(o=>o.type==="bulb"&&o.isActive),r=n.components.find(o=>o.type==="fan"&&o.isActive),l=n.components.find(o=>o.type==="bell"&&o.isActive);return t.isPowered&&!!c&&!!r&&!!l}},He=({onComplete:n})=>{const[t,c]=m.useState(null),[r,l]=m.useState(!1),[o,f]=m.useState(!1),[x,y]=m.useState(!1),[h,B]=m.useState(0),[D,E]=m.useState(0),[N,O]=m.useState(0),[W]=m.useState(new Set),p=m.useRef({components:[],wires:[]}),[A,F]=m.useState({isComplete:!1,isPowered:!1});m.useEffect(()=>{S()},[]);const S=T=>{const M=Ee();c(M),p.current={components:[],wires:[]},F({isComplete:!1,isPowered:!1}),O(I=>I+1),l(!1),f(!1)},G=m.useCallback(T=>{p.current=T},[]),H=m.useCallback(T=>{F(T)},[]),V=()=>{if(!t)return;const T=p.current,M={};t.requiredComponents.forEach(L=>{M[L]=(M[L]||0)+1});const I={};T.components.forEach(L=>{I[L.type]=(I[L.type]||0)+1});const R=Object.entries(M).every(([L,K])=>(I[L]||0)>=K),_=(t.validator&&ie[t.validator]?ie[t.validator]:ie.validateBasicCircuit)(T,A),U=R&&_;if(console.log("Validation:",{hasAllRequired:R,requiredCounts:M,actualCounts:I,circuitStatus:A,circuitWorks:_,success:U}),f(U),l(!0),U){const L=W.has(t.id);y(L),L||(W.add(t.id),B(K=>K+1),E(K=>K+((t==null?void 0:t.difficulty)||1)),n==null||n((t==null?void 0:t.difficulty)||1))}else y(!1)},Y=()=>{S()},Z=T=>e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(M=>e.jsx(ue,{size:20,className:M<=T?"text-yellow-400 fill-yellow-400":"text-gray-600"},M))});return t?e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-100 to-amber-100 rounded-lg px-3 py-2 mb-2 border border-orange-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"text-xl",children:"üéØ"}),e.jsx("h3",{className:"font-bold text-orange-800 truncate",children:t.title}),Z(t.difficulty),e.jsx("span",{className:"text-gray-600 text-sm hidden sm:inline",children:"‚Äî"}),e.jsx("p",{className:"text-gray-600 text-sm truncate hidden sm:inline",children:t.description})]}),e.jsxs("button",{onClick:()=>S(),className:"flex items-center gap-1 px-2 py-1 bg-white hover:bg-orange-50 rounded-md text-orange-600 transition-all border border-orange-200 text-sm shrink-0",children:[e.jsx($e,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"ƒê·ªïi ƒë·ªÅ"})]})]}),t.hint&&e.jsxs("p",{className:"text-orange-600/80 text-xs mt-1 truncate",children:["üí° ",t.hint]})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(re,{onChange:G,onCircuitStatusChange:H},N)}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between mt-4 pt-4 border-t border-white/10 bg-gradient-to-t from-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-white/50 text-sm",children:["ƒê√£ ho√†n th√†nh: ",e.jsx("span",{className:"text-white font-semibold",children:h})]}),e.jsxs("div",{className:"flex items-center gap-1 text-yellow-400 text-sm",children:[e.jsx(ue,{size:16,className:"fill-yellow-400"}),e.jsx("span",{className:"font-semibold",children:D})]})]}),e.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-500 rounded-xl text-white font-semibold transition-all",children:[e.jsx(oe,{size:20}),"Ki·ªÉm tra"]})]}),r&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:`
                        w-full max-w-md p-6 rounded-2xl text-center
                        ${o?"bg-gradient-to-br from-green-900 to-green-800 border-2 border-green-500":"bg-gradient-to-br from-red-900 to-red-800 border-2 border-red-500"}
                    `,children:[e.jsx("div",{className:"text-6xl mb-4",children:o?"üéâ":"ü§î"}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:o?"Tuy·ªát v·ªùi!":"Ch∆∞a ƒë√∫ng!"}),e.jsx("p",{className:"text-white/70 mb-4",children:o?x?"B·∫°n ƒë√£ l√†m b√†i n√†y r·ªìi n√™n kh√¥ng nh·∫≠n th√™m sao.":`B·∫°n ƒë√£ ho√†n th√†nh nhi·ªám v·ª• v√† nh·∫≠n ƒë∆∞·ª£c ${t.difficulty} sao!`:A.isPowered?"M·∫°ch ƒëang ch·∫°y nh∆∞ng ch∆∞a ƒë·ªß linh ki·ªán y√™u c·∫ßu.":'H√£y b·∫•m "B·∫≠t ngu·ªìn" ƒë·ªÉ ki·ªÉm tra m·∫°ch ho·∫°t ƒë·ªông.'}),o&&e.jsx("div",{className:"flex justify-center gap-2 mb-6",children:Z(t.difficulty)}),e.jsx("div",{className:"flex gap-3 justify-center",children:o?e.jsxs("button",{onClick:Y,className:"flex items-center gap-2 px-6 py-3 bg-white text-green-700 rounded-xl font-semibold hover:bg-green-100 transition-all",children:[e.jsx(Le,{size:20}),"B√†i ti·∫øp theo"]}):e.jsx("button",{onClick:()=>l(!1),className:"flex items-center gap-2 px-6 py-3 bg-white text-red-700 rounded-xl font-semibold hover:bg-red-100 transition-all",children:"Th·ª≠ l·∫°i"})})]})})]}):null},Ke=n=>({2:{components:[{id:"bat1",type:"battery",x:80,y:180,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:300,y:80,rotation:0,state:"on",isActive:!1}],wires:[{id:"w1",fromId:"bat1",fromPort:"output",toId:"bulb1",toPort:"input"}]},3:{components:[{id:"bat1",type:"battery",x:100,y:150,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:300,y:150,rotation:0,state:"on",isActive:!1}],wires:[]},4:{components:[{id:"bat1",type:"battery",x:80,y:180,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:320,y:80,rotation:0,state:"on",isActive:!1},{id:"sw1",type:"switch",x:200,y:180,rotation:0,state:"off",isActive:!1}],wires:[]},5:{components:[{id:"bat1",type:"battery",x:100,y:200,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:300,y:100,rotation:0,state:"on",isActive:!1}],wires:[]},6:{components:[{id:"bat1",type:"battery",x:80,y:200,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:220,y:80,rotation:0,state:"on",isActive:!1},{id:"bulb2",type:"bulb",x:360,y:80,rotation:0,state:"on",isActive:!1},{id:"sw1",type:"switch",x:220,y:200,rotation:0,state:"off",isActive:!1}],wires:[]},7:{components:[{id:"bat1",type:"battery",x:100,y:200,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:280,y:80,rotation:0,state:"on",isActive:!1},{id:"bulb2",type:"bulb",x:400,y:80,rotation:0,state:"on",isActive:!1}],wires:[]}})[n]||{components:[],wires:[]},Ge={1:[{id:"electron-movement",text:"A. Electron di chuy·ªÉn trong d√¢y d·∫´n"},{id:"light-creation",text:"B. Pin t·∫°o ra √°nh s√°ng"},{id:"wire-electricity",text:"C. D√¢y d·∫´n t·ª± ph√°t ƒëi·ªán"}],3:[{id:"control-circuit",text:"A. ƒê√≥ng/m·ªü m·∫°ch ƒëi·ªán"},{id:"create-power",text:"B. T·∫°o ra ƒëi·ªán"},{id:"store-power",text:"C. L∆∞u tr·ªØ ƒëi·ªán"}],8:[{id:"series",text:"A. M·∫°ch n·ªëi ti·∫øp - t·∫•t c·∫£ ƒë√®n t·∫Øt c√πng nhau"},{id:"parallel",text:"B. M·∫°ch song song - c√°c ƒë√®n ho·∫°t ƒë·ªông ƒë·ªôc l·∫≠p"},{id:"no-difference",text:"C. Kh√¥ng c√≥ s·ª± kh√°c bi·ªát"}]},Xe=({lessonId:n,correctAnswer:t,selectedAnswer:c,onSelectAnswer:r})=>{const l=Ge[n]||[];return e.jsx("div",{className:"space-y-2",children:l.map(o=>{const f=c===o.id,x=o.id===t,y=f&&x;return e.jsxs("button",{onClick:()=>r(o.id),className:`w-full p-3 rounded-lg text-left transition-all border flex items-center justify-between ${y?"bg-emerald-100 border-emerald-400 text-emerald-800":f&&!x?"bg-red-100 border-red-300 text-red-800":"bg-sky-50 hover:bg-sky-100 border-sky-200 text-sky-800"}`,children:[e.jsx("span",{children:o.text}),y&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-500 flex items-center justify-center",children:e.jsx(oe,{size:16,className:"text-white"})})]},o.id)})})},nt=()=>{const n=Ae(),[t,c]=m.useState("menu"),[r,l]=m.useState(null),[o,f]=m.useState(null),[x,y]=m.useState({isComplete:!1,isPowered:!1}),h=te.find(p=>p.id===r);m.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const B=p=>{console.log("Earned stars:",p)},D=()=>e.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"text-7xl mb-4 animate-bounce",children:"‚ö°"}),e.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-orange-400 to-pink-400",children:"ƒêi·ªán & M·∫°ch ƒëi·ªán"}),e.jsx("p",{className:"text-orange-700 mt-2 text-lg",children:"H·ªçc c√°ch l·∫Øp r√°p m·∫°ch ƒëi·ªán qua th√≠ nghi·ªám t∆∞∆°ng t√°c üîå"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("button",{onClick:()=>c("lessons"),className:"group p-6 bg-gradient-to-br from-sky-400 to-blue-500 rounded-2xl border-2 border-sky-300 hover:border-white shadow-lg shadow-blue-500/30 transition-all hover:scale-105 hover:shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white/30 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(Be,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"üìö H·ªçc theo b√†i"}),e.jsx("p",{className:"text-white/90 text-sm",children:"8 b√†i h·ªçc t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao v·ªõi l√Ω thuy·∫øt v√† b√†i t·∫≠p"})]}),e.jsxs("button",{onClick:()=>c("playground"),className:"group p-6 bg-gradient-to-br from-emerald-400 to-green-500 rounded-2xl border-2 border-emerald-300 hover:border-white shadow-lg shadow-green-500/30 transition-all hover:scale-105 hover:shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white/30 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(Te,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"üéÆ Th·ª≠ th√°ch"}),e.jsx("p",{className:"text-white/90 text-sm",children:"Ho√†n th√†nh c√°c nhi·ªám v·ª• l·∫Øp m·∫°ch v√† nh·∫≠n sao th∆∞·ªüng ‚≠ê"})]}),e.jsxs("button",{onClick:()=>c("sandbox"),className:"group p-6 bg-gradient-to-br from-violet-400 to-purple-500 rounded-2xl border-2 border-violet-300 hover:border-white shadow-lg shadow-purple-500/30 transition-all hover:scale-105 hover:shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white/30 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(pe,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"üß™ T·ª± do"}),e.jsx("p",{className:"text-white/90 text-sm",children:"Tho·∫£i m√°i th√≠ nghi·ªám v√† s√°ng t·∫°o m·∫°ch ƒëi·ªán c·ªßa ri√™ng b·∫°n üí°"})]})]})]}),E=()=>e.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-orange-800 mb-6",children:"üìö Danh s√°ch b√†i h·ªçc"}),e.jsx("div",{className:"space-y-3",children:te.map(p=>e.jsxs("button",{onClick:()=>{l(p.id),f(null),y({isComplete:!1,isPowered:!1}),c("lesson-detail")},className:"w-full flex items-center gap-4 p-4 bg-white hover:bg-orange-50 rounded-xl border-2 border-orange-200 hover:border-orange-400 shadow-sm hover:shadow-md transition-all text-left",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-400 to-amber-500 rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-md",children:p.id}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-900 font-semibold",children:p.title}),e.jsx("p",{className:"text-orange-600/70 text-sm",children:p.subtitle})]}),e.jsx(me,{size:20,className:"text-orange-400 rotate-180"})]},p.id))})]}),N=()=>h?e.jsx("div",{className:"max-w-4xl mx-auto py-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center bg-white rounded-2xl p-6 shadow-md border-2 border-orange-200",children:[e.jsxs("span",{className:"text-orange-500 text-sm font-semibold",children:["üìñ B√†i ",h.id]}),e.jsx("h2",{className:"text-3xl font-bold text-orange-800 mt-1",children:h.title}),e.jsx("p",{className:"text-orange-600/80",children:h.subtitle})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border-2 border-sky-200 shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-sky-600 mb-3",children:"üìñ L√Ω thuy·∫øt"}),e.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:h.theory.content}),e.jsx("div",{className:"space-y-2",children:h.theory.keyPoints.map((p,A)=>e.jsxs("div",{className:"flex items-start gap-2 text-gray-600",children:[e.jsx("span",{className:"text-sky-500",children:"‚Ä¢"}),p]},A))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border-2 border-emerald-200 shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-emerald-600 mb-3",children:"‚úèÔ∏è B√†i t·∫≠p"}),e.jsx("p",{className:"text-gray-700 mb-4",children:h.exercise.instruction}),(h.exercise.type==="build"||h.exercise.type==="fix")&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-[350px] bg-gradient-to-br from-sky-50 to-blue-100 rounded-xl border border-sky-200 overflow-hidden",children:e.jsx(re,{initialCircuit:Ke(h.id),hideToolbar:!0,onCircuitStatusChange:y},h.id)}),x.isPowered&&x.isComplete?e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-100 border-2 border-emerald-400 rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500 flex items-center justify-center",children:e.jsx(oe,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-emerald-800",children:"üéâ Tuy·ªát v·ªùi! M·∫°ch ho·∫°t ƒë·ªông!"}),e.jsx("p",{className:"text-emerald-600 text-sm",children:"B·∫°n ƒë√£ ho√†n th√†nh b√†i t·∫≠p n√†y"})]})]}):e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-50 border-2 border-amber-300 rounded-xl",children:[e.jsx("div",{className:"text-2xl",children:"üí°"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-amber-800",children:["G·ª£i √Ω: ",x.isPowered?"B·∫≠t ngu·ªìn ƒëi·ªán ƒë·ªÉ test":"H√£y n·ªëi m·∫°ch th√†nh v√≤ng k√≠n"]}),e.jsx("p",{className:"text-amber-600 text-sm",children:"M·∫°ch c·∫ßn k√≠n v√† ngu·ªìn b·∫≠t ƒë·ªÉ ƒë√®n s√°ng"})]})]})]}),h.exercise.type==="quiz"&&e.jsx(Xe,{lessonId:h.id,correctAnswer:h.exercise.correctAnswer,selectedAnswer:o,onSelectAnswer:f})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("button",{onClick:()=>{h.id>1&&(l(h.id-1),f(null),y({isComplete:!1,isPowered:!1}))},disabled:h.id===1,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-gray-700 transition-colors",children:"‚Üê B√†i tr∆∞·ªõc"}),e.jsx("button",{onClick:()=>{h.id<te.length&&(l(h.id+1),f(null),y({isComplete:!1,isPowered:!1}))},disabled:h.id===te.length,className:"px-4 py-2 bg-gradient-to-r from-orange-400 to-amber-500 hover:from-orange-500 hover:to-amber-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white font-semibold shadow-md transition-colors",children:"B√†i ti·∫øp ‚Üí"})]})]})}):null,O=()=>e.jsx("div",{className:"h-[calc(100vh-120px)]",children:e.jsx("div",{className:"bg-white rounded-2xl border-2 border-orange-200 shadow-lg h-full overflow-hidden",children:e.jsx(He,{onComplete:B})})}),W=()=>e.jsxs("div",{className:"h-[calc(100vh-120px)]",children:[e.jsx("div",{className:"text-center text-orange-700 mb-2 font-medium text-lg",children:"üß™ Ch·∫ø ƒë·ªô t·ª± do - Th·ªèa s·ª©c s√°ng t·∫°o! üí°"}),e.jsx("div",{className:"h-[calc(100%-40px)] bg-white rounded-2xl border-2 border-purple-200 shadow-lg overflow-hidden",children:e.jsx(re,{})})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-100 via-orange-100 to-yellow-100 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>t==="menu"?n("/science"):c("menu"),className:"flex items-center gap-2 px-4 py-2 bg-orange-500 hover:bg-orange-600 rounded-xl text-white shadow-md transition-colors",children:[e.jsx(me,{size:20}),e.jsx("span",{className:"hidden sm:inline",children:t==="menu"?"Khoa h·ªçc":"Menu"})]}),e.jsx("h1",{className:"text-xl font-bold text-orange-800 flex items-center gap-2",children:"‚ö° ƒêi·ªán & M·∫°ch ƒëi·ªán"}),e.jsx(Se,{})]}),t==="menu"&&D(),t==="lessons"&&E(),t==="lesson-detail"&&N(),t==="playground"&&O(),t==="sandbox"&&W()]})};export{nt as ElectricityPage};
