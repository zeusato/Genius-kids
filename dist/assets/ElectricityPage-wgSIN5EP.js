import{j as e,f as re,r as p,S as xe,u as Be,a as qe,b as Ee,A as be}from"./index-BR52Rtky.js";import{M as De}from"./MusicControls-B3aDTWZG.js";import{Z as ge}from"./zap-Bv_1jSY5.js";import{Z as Re,U as Oe,R as We}from"./zap-off-D435T7u6.js";import{T as Xe}from"./trash-2-D0y6ASjs.js";import{C as ce}from"./check-Ch5beXFI.js";import{A as He}from"./arrow-right-CZNSDgAR.js";import{B as Ke}from"./book-open-B6uaPslY.js";import{G as Ye}from"./gamepad-2-BGzEuaiR.js";import"./volume-x-CFQy3J5n.js";const le={battery:{type:"battery",name:"Pin",icon:"üîã",description:"Ngu·ªìn ƒëi·ªán cung c·∫•p nƒÉng l∆∞·ª£ng cho m·∫°ch",hasInput:!0,hasOutput:!0,isSource:!0,isLoad:!1,isPassive:!1},bulb:{type:"bulb",name:"ƒê√®n",icon:"üí°",description:"Ph√°t s√°ng khi c√≥ d√≤ng ƒëi·ªán ch·∫°y qua",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1},switch:{type:"switch",name:"C√¥ng t·∫Øc",icon:"üîò",description:"ƒê√≥ng/m·ªü m·∫°ch ƒëi·ªán, click ƒë·ªÉ b·∫≠t/t·∫Øt",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!1,isPassive:!0},wire:{type:"wire",name:"D√¢y d·∫´n",icon:"üìè",description:"K·∫øt n·ªëi c√°c linh ki·ªán v·ªõi nhau",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!1,isPassive:!0},bell:{type:"bell",name:"Chu√¥ng",icon:"üîî",description:"Rung v√† ph√°t ti·∫øng k√™u khi c√≥ ƒëi·ªán",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1},fan:{type:"fan",name:"Qu·∫°t",icon:"üåÄ",description:"Quay t·∫°o gi√≥ khi c√≥ ƒëi·ªán, c√≥ th·ªÉ th·ªïi t·∫Øt n·∫øn",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1},candle:{type:"candle",name:"N·∫øn",icon:"üïØÔ∏è",description:"Ng·ªçn n·∫øn ƒëang ch√°y, t·∫Øt khi c√≥ gi√≥ t·ª´ qu·∫°t",hasInput:!1,hasOutput:!1,isSource:!1,isLoad:!1,isPassive:!0},buzzer:{type:"buzzer",name:"C√≤i",icon:"üì¢",description:"Ph√°t √¢m thanh b√°o ƒë·ªông khi c√≥ ƒëi·ªán",hasInput:!0,hasOutput:!0,isSource:!1,isLoad:!0,isPassive:!1}},ne=[{id:1,title:"D√≤ng ƒëi·ªán l√† g√¨?",subtitle:"Hi·ªÉu v·ªÅ electron v√† s·ª± di chuy·ªÉn c·ªßa ch√∫ng",theory:{content:"D√≤ng ƒëi·ªán l√† s·ª± di chuy·ªÉn c·ªßa c√°c h·∫°t electron qua d√¢y d·∫´n. Gi·ªëng nh∆∞ n∆∞·ªõc ch·∫£y trong ·ªëng, electron ch·∫£y trong d√¢y ƒë·ªìng khi c√≥ ngu·ªìn ƒëi·ªán.",keyPoints:["Electron l√† h·∫°t r·∫•t nh·ªè mang ƒëi·ªán √¢m (-)","Khi electron di chuy·ªÉn ‚Üí t·∫°o ra d√≤ng ƒëi·ªán","C·∫ßn c√≥ ngu·ªìn (pin) ƒë·ªÉ ƒë·∫©y electron ƒëi"]},illustration:{type:"animation",data:{showElectronFlow:!0}},exercise:{type:"quiz",instruction:"D√≤ng ƒëi·ªán l√† g√¨?",correctAnswer:"electron-movement"}},{id:2,title:"M·∫°ch k√≠n v√† m·∫°ch h·ªü",subtitle:"T·∫°i sao ƒë√®n ph·∫£i trong m·∫°ch k√≠n m·ªõi s√°ng?",theory:{content:"M·∫°ch k√≠n l√† khi c√°c linh ki·ªán n·ªëi th√†nh v√≤ng tr√≤n li√™n t·ª•c. M·∫°ch h·ªü l√† khi c√≥ ch·ªó b·ªã ƒë·ª©t. Electron ch·ªâ ch·∫°y ƒë∆∞·ª£c trong m·∫°ch k√≠n!",keyPoints:["M·∫°ch k√≠n = v√≤ng li√™n t·ª•c t·ª´ (+) v·ªÅ (-) c·ªßa pin","M·∫°ch h·ªü = c√≥ ch·ªó ƒë·ª©t, electron kh√¥ng ch·∫°y ƒë∆∞·ª£c","ƒê√®n ch·ªâ s√°ng khi ·ªü trong m·∫°ch k√≠n"]},illustration:{type:"comparison",data:{showClosed:!0,showOpen:!0}},exercise:{type:"fix",instruction:"K√©o th√™m d√¢y ƒë·ªÉ n·ªëi m·∫°ch h·ªü th√†nh m·∫°ch k√≠n"}},{id:3,title:"Ngu·ªìn ƒëi·ªán - Pin",subtitle:"C·ª±c (+) v√† c·ª±c (-) c·ªßa pin",theory:{content:"Pin c√≥ 2 c·ª±c: c·ª±c d∆∞∆°ng (+) v√† c·ª±c √¢m (-). Pin ƒë·∫©y electron t·ª´ c·ª±c (-) ƒëi v√≤ng qua m·∫°ch r·ªìi v·ªÅ c·ª±c (+). Ph·∫£i n·ªëi ƒë√∫ng chi·ªÅu pin m·ªõi ho·∫°t ƒë·ªông!",keyPoints:["Pin c√≥ 2 ƒë·∫ßu: (+) d∆∞∆°ng v√† (-) √¢m","Electron ƒëi t·ª´ (-) ‚Üí qua m·∫°ch ‚Üí v·ªÅ (+)","Pin cung c·∫•p nƒÉng l∆∞·ª£ng cho d√≤ng ƒëi·ªán ch·∫°y"]},illustration:{type:"diagram",data:{showBatteryPoles:!0}},exercise:{type:"build",instruction:"ƒê·∫∑t pin v√†o ƒë√∫ng v·ªã tr√≠ ƒë·ªÉ ƒë√®n s√°ng"}},{id:4,title:"C√¥ng t·∫Øc ƒëi·ªán",subtitle:"ƒê√≥ng/m·ªü m·∫°ch m·ªôt c√°ch an to√†n",theory:{content:"C√¥ng t·∫Øc gi√∫p ƒë√≥ng ho·∫∑c m·ªü m·∫°ch ƒëi·ªán. Khi b·∫≠t = m·∫°ch k√≠n = ƒë√®n s√°ng. Khi t·∫Øt = m·∫°ch h·ªü = ƒë√®n t·∫Øt. D√πng c√¥ng t·∫Øc an to√†n h∆°n r√∫t d√¢y!",keyPoints:["C√¥ng t·∫Øc B·∫¨T = m·∫°ch k√≠n = c√≥ d√≤ng ƒëi·ªán","C√¥ng t·∫Øc T·∫ÆT = m·∫°ch h·ªü = kh√¥ng c√≥ d√≤ng ƒëi·ªán","Lu√¥n d√πng c√¥ng t·∫Øc ƒë·ªÉ b·∫≠t/t·∫Øt thi·∫øt b·ªã ƒëi·ªán"]},illustration:{type:"animation",data:{showSwitchToggle:!0}},exercise:{type:"build",instruction:"Th√™m c√¥ng t·∫Øc v√†o m·∫°ch ƒë·ªÉ ƒëi·ªÅu khi·ªÉn ƒë√®n"}},{id:5,title:"L·∫Øp m·∫°ch ƒë∆°n gi·∫£n",subtitle:"Pin + D√¢y + ƒê√®n = √Ånh s√°ng!",theory:{content:"M·∫°ch ƒëi·ªán ƒë∆°n gi·∫£n nh·∫•t g·ªìm: Pin (ngu·ªìn), D√¢y d·∫´n (ƒë∆∞·ªùng ƒëi), ƒê√®n (t·∫£i). N·ªëi ch√∫ng th√†nh v√≤ng k√≠n v√† ƒë√®n s·∫Ω s√°ng!",keyPoints:["Ngu·ªìn: Pin cung c·∫•p nƒÉng l∆∞·ª£ng","D√¢y d·∫´n: ƒê∆∞·ªùng cho electron ch·∫°y","T·∫£i: ƒê√®n bi·∫øn ƒëi·ªán th√†nh √°nh s√°ng"]},illustration:{type:"diagram",data:{showSimpleCircuit:!0}},exercise:{type:"build",instruction:"T·ª± l·∫Øp m·∫°ch ho√†n ch·ªânh: Pin ‚Üí D√¢y ‚Üí ƒê√®n ‚Üí D√¢y ‚Üí Pin"}},{id:6,title:"M·∫°ch n·ªëi ti·∫øp",subtitle:"C√°c linh ki·ªán x·∫øp th√†nh 1 h√†ng",theory:{content:"M·∫°ch n·ªëi ti·∫øp: c√°c linh ki·ªán n·ªëi th√†nh M·ªòT ƒë∆∞·ªùng duy nh·∫•t. N·∫øu 1 ƒë√®n t·∫Øt ‚Üí c·∫£ m·∫°ch m·∫•t ƒëi·ªán ‚Üí t·∫•t c·∫£ ƒë√®n t·∫Øt!",keyPoints:["C√°c linh ki·ªán n·ªëi th√†nh 1 ƒë∆∞·ªùng","1 ƒë√®n h·ªèng = c·∫£ d√£y t·∫Øt","C√†ng nhi·ªÅu ƒë√®n ‚Üí m·ªói ƒë√®n c√†ng m·ªù"]},illustration:{type:"diagram",data:{showSeriesCircuit:!0}},exercise:{type:"build",instruction:"L·∫Øp 2 b√≥ng ƒë√®n N·ªêI TI·∫æP v·ªõi nhau"}},{id:7,title:"M·∫°ch song song",subtitle:"M·ªói linh ki·ªán c√≥ ƒë∆∞·ªùng ri√™ng",theory:{content:"M·∫°ch song song: m·ªói linh ki·ªán c√≥ NH√ÅNH RI√äNG n·ªëi v·ªõi pin. N·∫øu 1 ƒë√®n t·∫Øt ‚Üí c√°c ƒë√®n kh√°c v·∫´n s√°ng b√¨nh th∆∞·ªùng!",keyPoints:["M·ªói ƒë√®n c√≥ ƒë∆∞·ªùng ri√™ng ƒë·∫øn pin","1 ƒë√®n h·ªèng ‚â† ·∫£nh h∆∞·ªüng ƒë√®n kh√°c","C√°c ƒë√®n s√°ng ƒë·ªÅu nh∆∞ nhau"]},illustration:{type:"diagram",data:{showParallelCircuit:!0}},exercise:{type:"build",instruction:"L·∫Øp 2 b√≥ng ƒë√®n SONG SONG v·ªõi nhau"}},{id:8,title:"So s√°nh v√† ·ª©ng d·ª•ng",subtitle:"Khi n√†o d√πng n·ªëi ti·∫øp, khi n√†o d√πng song song?",theory:{content:"N·ªëi ti·∫øp: ƒë∆°n gi·∫£n, ti·∫øt ki·ªám d√¢y, nh∆∞ng 1 h·ªèng = t·∫•t c·∫£ h·ªèng. Song song: ph·ª©c t·∫°p h∆°n, t·ªën d√¢y, nh∆∞ng an to√†n v√† ƒë√®n s√°ng ƒë·ªÅu.",keyPoints:["ƒê√®n trang tr√≠ th∆∞·ªùng N·ªêI TI·∫æP","ƒê√®n trong nh√† th∆∞·ªùng SONG SONG","Ch·ªçn lo·∫°i m·∫°ch ph√π h·ª£p v·ªõi m·ª•c ƒë√≠ch"]},illustration:{type:"comparison",data:{compareSeries:!0,compareParallel:!0}},exercise:{type:"quiz",instruction:"Nh√† b·∫°n n√™n d√πng m·∫°ch g√¨ ƒë·ªÉ khi 1 ƒë√®n h·ªèng, c√°c ƒë√®n kh√°c v·∫´n s√°ng?",correctAnswer:"parallel"}}],Ge=[{id:"e1",difficulty:1,title:"Th·∫Øp s√°ng ƒë√®n",description:"L·∫Øp m·∫°ch ƒë∆°n gi·∫£n ƒë·ªÉ l√†m ƒë√®n s√°ng",hint:"C·∫ßn: Pin + ƒê√®n, n·ªëi d√¢y gi·ªØa ch√∫ng",requiredComponents:["battery","bulb"],validator:"validateBulbOn"},{id:"e2",difficulty:1,title:"Th√™m c√¥ng t·∫Øc",description:"L·∫Øp m·∫°ch c√≥ c√¥ng t·∫Øc ƒë·ªÉ b·∫≠t/t·∫Øt ƒë√®n",hint:"Th√™m c√¥ng t·∫Øc v√†o gi·ªØa m·∫°ch",requiredComponents:["battery","bulb","switch"],validator:"validateSwitchControls"},{id:"e3",difficulty:1,title:"Chu√¥ng c·ª≠a",description:"L·∫Øp chu√¥ng c√≥ th·ªÉ b·∫•m ƒë·ªÉ k√™u",hint:"D√πng c√¥ng t·∫Øc nh∆∞ n√∫t b·∫•m",requiredComponents:["battery","bell","switch"],validator:"validateBellWorks"},{id:"m1",difficulty:2,title:"Hai ƒë√®n n·ªëi ti·∫øp",description:"L·∫Øp 2 ƒë√®n n·ªëi ti·∫øp v·ªõi 1 c√¥ng t·∫Øc ƒëi·ªÅu khi·ªÉn c·∫£ 2",hint:"C√°c ƒë√®n n·ªëi th√†nh 1 h√†ng",requiredComponents:["battery","bulb","bulb","switch"],validator:"validateSeriesBulbs"},{id:"m2",difficulty:2,title:"Hai ƒë√®n song song",description:"L·∫Øp 2 ƒë√®n song song",hint:"M·ªói ƒë√®n c·∫ßn c√≥ ƒë∆∞·ªùng ri√™ng",requiredComponents:["battery","bulb","bulb"],validator:"validateParallelBulbs"},{id:"m3",difficulty:2,title:"Qu·∫°t th√¥ng gi√≥",description:"L·∫Øp qu·∫°t c√≥ c√¥ng t·∫Øc ƒëi·ªÅu khi·ªÉn",hint:"Gi·ªëng m·∫°ch ƒë√®n, thay ƒë√®n b·∫±ng qu·∫°t",requiredComponents:["battery","fan","switch"],validator:"validateFanWorks"},{id:"m4",difficulty:2,title:"Th·ªïi t·∫Øt n·∫øn",description:"D√πng qu·∫°t ƒëi·ªán ƒë·ªÉ th·ªïi t·∫Øt n·∫øn ƒëang ch√°y",hint:"ƒê·∫∑t qu·∫°t g·∫ßn n·∫øn, b·∫≠t qu·∫°t ƒë·ªÉ t·∫°o gi√≥",requiredComponents:["battery","fan","switch","candle"],validator:"validateCandleBlown"},{id:"h1",difficulty:3,title:"ƒêi·ªÅu khi·ªÉn ƒë·ªôc l·∫≠p",description:"L·∫Øp 2 ƒë√®n, m·ªói ƒë√®n c√≥ c√¥ng t·∫Øc ri√™ng",hint:"M·ªói ƒë√®n 1 nh√°nh v·ªõi 1 c√¥ng t·∫Øc",requiredComponents:["battery","bulb","bulb","switch","switch"],validator:"validateIndependentControl"},{id:"h2",difficulty:3,title:"H·ªá th·ªëng b√°o ƒë·ªông",description:"L·∫Øp chu√¥ng V√Ä c√≤i c√πng k√™u khi b·∫≠t c√¥ng t·∫Øc",hint:"Chu√¥ng v√† c√≤i n·ªëi song song",requiredComponents:["battery","bell","buzzer","switch"],validator:"validateAlarmSystem"},{id:"h3",difficulty:3,title:"Ph√≤ng th√¥ng minh",description:"ƒê√®n s√°ng + qu·∫°t quay, ƒëi·ªÅu khi·ªÉn ri√™ng bi·ªát",hint:"ƒê√®n v√† qu·∫°t m·ªói c√°i 1 c√¥ng t·∫Øc ri√™ng",requiredComponents:["battery","bulb","fan","switch","switch"],validator:"validateSmartRoom"},{id:"e4",difficulty:1,title:"C√≤i b√°o hi·ªáu",description:"L·∫Øp c√≤i ƒë∆°n gi·∫£n v·ªõi pin",hint:"N·ªëi c√≤i v√†o pin qua d√¢y d·∫´n",requiredComponents:["battery","buzzer"],validator:"validateBuzzerWorks"},{id:"e5",difficulty:1,title:"Qu·∫°t mini",description:"L·∫Øp qu·∫°t ch·∫°y b·∫±ng pin",hint:"N·ªëi pin v·ªõi qu·∫°t",requiredComponents:["battery","fan"],validator:"validateFanWorks"},{id:"m5",difficulty:2,title:"ƒê√®n v√† chu√¥ng",description:"L·∫Øp ƒë√®n V√Ä chu√¥ng c√πng ho·∫°t ƒë·ªông",hint:"N·ªëi song song ƒë√®n v√† chu√¥ng",requiredComponents:["battery","bulb","bell","switch"],validator:"validateBulbAndBell"},{id:"m6",difficulty:2,title:"Ba ƒë√®n n·ªëi ti·∫øp",description:"L·∫Øp 3 ƒë√®n n·ªëi ti·∫øp c√πng s√°ng",hint:"N·ªëi 3 ƒë√®n th√†nh 1 chu·ªói",requiredComponents:["battery","bulb","bulb","bulb"],validator:"validateThreeBulbsSeries"},{id:"h4",difficulty:3,title:"M·∫°ch ph·ª©c h·ª£p",description:"L·∫Øp ƒë√®n, qu·∫°t, chu√¥ng c√πng ho·∫°t ƒë·ªông v·ªõi c√¥ng t·∫Øc t·ªïng",hint:"N·ªëi t·∫•t c·∫£ song song r·ªìi th√™m c√¥ng t·∫Øc t·ªïng",requiredComponents:["battery","bulb","fan","bell","switch"],validator:"validateComplexCircuit"}];function Fe(s){let t=Ge;return t[Math.floor(Math.random()*t.length)]}const Ue=({component:s,isSelected:t,isConnecting:c,onClick:o,onToggle:a,onPortClick:l,onDragStart:g,isDragging:x,onTouchStart:k,onTouchMove:N,onTouchEnd:w})=>{const d=le[s.type],y=s.isActive,S=s.type==="switch"?s.state:null,X=(()=>{switch(s.type){case"battery":return{bg:"bg-gradient-to-r from-red-500 to-slate-600",glow:y?"shadow-red-500/50":""};case"bulb":return{bg:y?"bg-yellow-400":"bg-slate-600",glow:y?"shadow-yellow-400/80 shadow-lg":""};case"switch":return{bg:S==="on"?"bg-green-500":"bg-slate-600",glow:S==="on"?"shadow-green-500/50":""};case"bell":return{bg:y?"bg-yellow-500":"bg-slate-600",glow:y?"shadow-yellow-500/50":""};case"fan":return{bg:y?"bg-cyan-500":"bg-slate-600",glow:y?"shadow-cyan-500/50":""};case"candle":return{bg:s.isActive?"bg-slate-500":"bg-orange-400",glow:s.isActive?"":"shadow-orange-400/50"};case"buzzer":return{bg:y?"bg-purple-500":"bg-slate-600",glow:y?"shadow-purple-500/50":""};default:return{bg:"bg-slate-600",glow:""}}})(),R=f=>{f.stopPropagation(),s.type==="switch"&&a?a():o()},I=(f,H)=>{f.stopPropagation(),l==null||l(H)},j=f=>{f.target.closest(".port-button")||g==null||g(f)};return e.jsxs("div",{className:`
                absolute w-16 h-16 rounded-xl
                flex flex-col items-center justify-center
                ${x?"":"transition-all duration-200"}
                ${X.bg} ${X.glow}
                ${t?"ring-2 ring-cyan-400 ring-offset-2 ring-offset-slate-900":""}
                ${c?"ring-2 ring-cyan-400 animate-pulse":""}
                ${x?"cursor-grabbing scale-105 opacity-80":"cursor-grab"}
                hover:scale-105
            `,style:{left:s.x,top:s.y,transform:`rotate(${s.rotation}deg)`,zIndex:x?100:1},onClick:R,onMouseDown:j,onTouchStart:k,onTouchMove:N,onTouchEnd:w,children:[e.jsx("span",{className:`text-2xl select-none ${s.type==="fan"&&y?"animate-spin":""}`,children:d.icon}),s.type==="switch"&&e.jsx("span",{className:"text-[10px] text-white font-semibold mt-0.5 select-none",children:S==="on"?"B·∫¨T":"T·∫ÆT"}),s.type==="candle"&&!s.isActive&&e.jsx("div",{className:"absolute -top-2 text-sm animate-pulse select-none",children:"üî•"}),d.hasInput&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute -left-6 top-1/2 -translate-y-1/2 w-10 h-10 flex items-center justify-center z-20 cursor-pointer",onClick:f=>I(f,"input"),title:"ƒê·∫ßu v√†o (‚àí)",children:e.jsx("div",{className:"w-5 h-5 rounded-full bg-blue-500 border-2 border-white hover:scale-125 hover:bg-blue-400 transition-all shadow-sm"})}),s.type==="battery"&&e.jsx("span",{className:"absolute left-1 top-1/2 -translate-y-[55%] text-lg font-bold text-white select-none pointer-events-none drop-shadow-md",children:"‚àí"})]}),d.hasOutput&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute -right-6 top-1/2 -translate-y-1/2 w-10 h-10 flex items-center justify-center z-20 cursor-pointer",onClick:f=>I(f,"output"),title:"ƒê·∫ßu ra (+)",children:e.jsx("div",{className:"w-5 h-5 rounded-full bg-red-500 border-2 border-white hover:scale-125 hover:bg-red-400 transition-all shadow-sm"})}),s.type==="battery"&&e.jsx("span",{className:"absolute right-1 top-1/2 -translate-y-[55%] text-lg font-bold text-white select-none pointer-events-none drop-shadow-md",children:"+"})]})]})},Qe=({onDragStart:s,onMobileDrop:t,disabled:c})=>{const o=["battery","bulb","switch","bell","fan","candle","buzzer"],[a,l]=re.useState(null),[g,x]=re.useState(null);re.useEffect(()=>{if(!a)return;const N=d=>{d.preventDefault();const y=d.touches[0];x({x:y.clientX,y:y.clientY})},w=d=>{const y=d.changedTouches[0];y&&t&&t(a,y.clientX,y.clientY),l(null),x(null)};return window.addEventListener("touchmove",N,{passive:!1}),window.addEventListener("touchend",w),()=>{window.removeEventListener("touchmove",N),window.removeEventListener("touchend",w)}},[a,t]);const k=(N,w)=>{const d=w.touches[0];l(N),x({x:d.clientX,y:d.clientY}),navigator.vibrate&&navigator.vibrate(50)};return e.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-slate-800/50 rounded-xl border border-white/10",children:[e.jsx("h3",{className:"text-white/70 text-xs font-semibold uppercase tracking-wider mb-1 hidden md:block",children:"Linh ki·ªán"}),e.jsx("div",{className:"flex md:grid md:grid-cols-2 gap-2 overflow-x-auto md:overflow-visible pb-1 md:pb-0",children:o.map(N=>{const w=le[N];return e.jsxs("button",{draggable:!c,onTouchStart:d=>k(N,d),onDragStart:d=>{d.dataTransfer.setData("componentType",N),s(N)},disabled:c,className:`
                                flex flex-col items-center justify-center p-2 rounded-lg
                                bg-slate-700/50 border border-white/10
                                hover:bg-slate-600/50 hover:border-cyan-500/50
                                transition-all cursor-grab active:cursor-grabbing
                                flex-shrink-0 w-16 md:w-auto
                                ${c?"opacity-50 cursor-not-allowed":""}
                            `,title:w.description,children:[e.jsx("span",{className:"text-2xl mb-1",children:w.icon}),e.jsx("span",{className:"text-white/70 text-[10px] text-center leading-tight",children:w.name})]},N)})}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-white/10 hidden md:block",children:[e.jsx("p",{className:"text-white/40 text-[10px] text-center",children:"K√©o th·∫£ v√†o canvas"}),e.jsx("p",{className:"text-cyan-400/60 text-[10px] text-center mt-1",children:"üí° Nh·∫•n v√†o ƒë·∫ßu n·ªëi ƒë·ªÉ t·∫°o d√¢y"})]}),a&&g&&e.jsx("div",{className:"fixed pointer-events-none z-[9999] opacity-80",style:{left:g.x,top:g.y,transform:"translate(-50%, -50%)",width:"64px",height:"64px"},children:e.jsx("div",{className:"w-full h-full bg-slate-700/50 border border-cyan-500 rounded-xl flex items-center justify-center text-3xl shadow-xl backdrop-blur-sm",children:le[a].icon})})]})};let Ve=0,Ze=0;const ae=({initialCircuit:s,onChange:t,onCircuitStatusChange:c,readOnly:o=!1,hideToolbar:a=!1})=>{const[l,g]=p.useState((s==null?void 0:s.components)||[]),[x,k]=p.useState((s==null?void 0:s.wires)||[]),[N,w]=p.useState(null),[d,y]=p.useState(!1),[S,Y]=p.useState(!1),[X,R]=p.useState(new Map),[I,j]=p.useState([]),[f,H]=p.useState(null),[O,F]=p.useState(null),[U,Z]=p.useState({x:0,y:0}),[q,L]=p.useState(null),A=p.useRef(null),W=p.useRef(null),Q=p.useRef(null);p.useEffect(()=>{t==null||t({components:l,wires:x})},[l,x]),p.useEffect(()=>{c==null||c({isComplete:d,isPowered:S})},[d,S,c]);const K=()=>{j(n=>[...n.slice(-19),{components:[...l],wires:[...x]}])},_=()=>{if(I.length===0)return;const n=I[I.length-1];g(n.components),k(n.wires),j(i=>i.slice(0,-1)),t==null||t({components:n.components,wires:n.wires})},E=p.useCallback(n=>{n.preventDefault();const i=n.dataTransfer.getData("componentType");!i||i==="wire"||de(i,n.clientX,n.clientY)},[l,x,t]),G=p.useCallback((n,i,r)=>{de(n,i,r)},[l,x,t]),de=(n,i,r)=>{if(!A.current)return;const u=A.current.getBoundingClientRect(),v=i-u.left,z=r-u.top;K();const P={id:`comp_${++Ve}`,type:n,x:Math.max(0,Math.min(v,u.width-64)),y:Math.max(0,Math.min(z,u.height-64)),rotation:0,state:n==="switch"?"off":"on",isActive:!1},M=[...l,P];g(M),t==null||t({components:M,wires:x})},fe=n=>{n.preventDefault(),n.dataTransfer.dropEffect="copy"},ye=(n,i)=>{const r=l.find(v=>v.id===n);if(!r||o||!A.current)return;const u=A.current.getBoundingClientRect();F(n),Z({x:i.clientX-u.left-r.x,y:i.clientY-u.top-r.y}),K()},ve=n=>{if(!O||!A.current)return;const i=A.current.getBoundingClientRect(),r=n.clientX-i.left-U.x,u=n.clientY-i.top-U.y;g(v=>v.map(z=>z.id===O?{...z,x:Math.max(0,Math.min(r,i.width-64)),y:Math.max(0,Math.min(u,i.height-64))}:z))},he=()=>{O&&(F(null),t==null||t({components:l,wires:x}))},we=(n,i)=>{if(o||!A.current)return;const r=i.touches[0];Q.current={x:r.clientX,y:r.clientY},W.current=setTimeout(()=>{const u=l.find(v=>v.id===n);if(u){F(n);const v=A.current.getBoundingClientRect();Z({x:r.clientX-v.left-u.x,y:r.clientY-v.top-u.y}),navigator.vibrate&&navigator.vibrate(50)}},500)},je=n=>{if(O&&A.current){n.preventDefault();const i=n.touches[0],r=A.current.getBoundingClientRect(),u=i.clientX-r.left-U.x,v=i.clientY-r.top-U.y;g(z=>z.map(P=>P.id===O?{...P,x:Math.max(0,Math.min(u,r.width-64)),y:Math.max(0,Math.min(v,r.height-64))}:P))}else if(Q.current){const i=n.touches[0],r=i.clientX-Q.current.x,u=i.clientY-Q.current.y;r*r+u*u>100&&W.current&&(clearTimeout(W.current),W.current=null)}},Ne=()=>{W.current&&(clearTimeout(W.current),W.current=null),O&&(F(null),t==null||t({components:l,wires:x})),Q.current=null},ke=(n,i)=>{if(!o)if(!f)H({id:n,port:i});else{if(f.id!==n){K();const r={id:`wire_${++Ze}`,fromId:f.id,fromPort:f.port,toId:n,toPort:i},u=[...x,r];k(u),t==null||t({components:l,wires:u}),S&&ee(l,u)}H(null)}},Pe=n=>{K();const i=l.map(r=>r.id===n?{...r,state:r.state==="on"?"off":"on"}:r);g(i),t==null||t({components:i,wires:x}),S&&ee(i,x)},Ce=()=>{K(),g([]),k([]),w(null),H(null),y(!1),Y(!1),t==null||t({components:[],wires:[]})},Se=n=>{if(o)return;K();const i=x.filter(r=>r.id!==n);k(i),L(null),t==null||t({components:l,wires:i}),S&&ee(l,i)},Ae=(n,i)=>{const r=n.find(h=>h.type==="battery");if(!r)return{activeIds:new Set,wireAnalysis:new Map};const u=new Map;n.forEach(h=>u.set(h.id,[])),i.forEach(h=>{var C,m;(C=u.get(h.fromId))==null||C.push({id:h.toId,wireId:h.id,myPort:h.fromPort,otherPort:h.toPort}),(m=u.get(h.toId))==null||m.push({id:h.fromId,wireId:h.id,myPort:h.toPort,otherPort:h.fromPort})});const v=new Map,z=[r.id];v.set(r.id,0);let P=0;for(;P<z.length;){const h=z[P++],C=u.get(h)||[];for(const m of C){if(h===r.id&&m.myPort!=="input")continue;const $=m.id,B=n.find(D=>D.id===$);(B==null?void 0:B.type)==="switch"&&B.state==="off"||v.has($)||(v.set($,v.get(h)+1),z.push($))}}const M=new Map,T=[r.id];for(M.set(r.id,0),P=0;P<T.length;){const h=T[P++],C=u.get(h)||[];for(const m of C){if(h===r.id&&m.myPort!=="output")continue;const $=m.id,B=n.find(D=>D.id===$);(B==null?void 0:B.type)==="switch"&&B.state==="off"||M.has($)||(M.set($,M.get(h)+1),T.push($))}}const b=new Set;n.forEach(h=>{h.type!=="battery"&&v.has(h.id)&&M.has(h.id)&&b.add(h.id)}),Array.from(b).some(h=>{const C=n.find(m=>m.id===h);return C&&["bulb","bell","fan","buzzer"].includes(C.type)})&&b.add(r.id);const V=new Map;return i.forEach(h=>{const C=h.fromId,m=h.toId,$=b.has(C),B=b.has(m);if($&&B){let D=!1;const se=n.find(J=>J.id===C),ie=n.find(J=>J.id===m),Te=(se==null?void 0:se.type)==="battery",ze=(ie==null?void 0:ie.type)==="battery";if(Te)h.fromPort==="input"?D=!1:h.fromPort==="output"&&(D=!0);else if(ze)h.toPort==="input"?D=!0:h.toPort==="output"&&(D=!1);else{const J=v.get(C)??9999,$e=M.get(C)??9999,me=J-$e,Le=v.get(m)??9999,Ie=M.get(m)??9999,pe=Le-Ie;me<pe?D=!1:me>pe&&(D=!0)}V.set(h.id,{isActive:!0,isReverse:D})}else V.set(h.id,{isActive:!1,isReverse:!1})}),{activeIds:b,wireAnalysis:V}},ee=(n,i,r)=>{if(!(r??S)){y(!1),g(n.map(b=>({...b,isActive:!1}))),R(new Map);return}const{activeIds:v,wireAnalysis:z}=Ae(n,i),P=n.map(b=>({...b,isActive:v.has(b.id)})),M=P.some(b=>["bulb","bell","fan","buzzer"].includes(b.type)&&b.isActive);y(M);const T=P.find(b=>b.type==="fan"&&b.isActive);T&&P.forEach(b=>{b.type==="candle"&&Math.sqrt(Math.pow(T.x-b.x,2)+Math.pow(T.y-b.y,2))<150&&(b.isActive=!0)}),g(P),R(z)},Me=()=>{const n=!S;Y(n),ee(l,x,n)},ue=(n,i)=>{const r=l.find(u=>u.id===n);return r?{x:r.x+(i==="input"?0:64),y:r.y+32}:{x:0,y:0}};return e.jsxs("div",{className:"flex flex-col-reverse md:flex-row gap-4 h-full",children:[!o&&!a&&e.jsx("div",{className:"w-full md:w-32 flex-shrink-0",children:e.jsx(Qe,{onDragStart:()=>{},onMobileDrop:G,disabled:!1})}),e.jsxs("div",{className:"flex-1 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-sky-100 to-blue-100 rounded-lg px-4 py-2 border border-sky-200 overflow-x-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 whitespace-nowrap",children:[e.jsxs("button",{onClick:Me,className:`
                                flex items-center gap-2 px-4 py-2 rounded-lg font-semibold transition-all shadow-md
                                ${S?"bg-gradient-to-r from-green-400 to-emerald-500 text-white shadow-lg shadow-green-400/30":"bg-gray-100 text-gray-600 hover:bg-gray-200 border border-gray-300"}
                            `,children:[S?e.jsx(ge,{size:18}):e.jsx(Re,{size:18}),S?"ƒêang ch·∫°y ‚ö°":"B·∫≠t ngu·ªìn"]}),e.jsx("span",{className:`text-sm px-3 py-1 rounded-full font-medium ${d?"bg-green-100 text-green-700 border border-green-300":"bg-red-100 text-red-700 border border-red-300"}`,children:d?"‚úì M·∫°ch k√≠n":"‚úó M·∫°ch h·ªü"}),f&&e.jsx("span",{className:"text-sm px-3 py-1 rounded-full bg-cyan-100 text-cyan-700 border border-cyan-300 animate-pulse font-medium",children:"N·ªëi d√¢y..."})]}),!o&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:_,disabled:I.length===0,className:"flex items-center gap-1 p-2 rounded-lg bg-white text-gray-600 hover:bg-gray-100 border border-gray-300 disabled:opacity-50 transition-all",title:"Ho√†n t√°c",children:e.jsx(Oe,{size:18})}),e.jsx("button",{onClick:Ce,className:"flex items-center gap-1 p-2 rounded-lg bg-white text-gray-600 hover:bg-red-100 hover:text-red-600 border border-gray-300 hover:border-red-300 transition-all",title:"X√≥a t·∫•t c·∫£",children:e.jsx(Xe,{size:18})})]})]}),e.jsxs("div",{ref:A,className:`
                        relative flex-1 min-h-[400px] bg-gradient-to-br from-sky-50 via-blue-50 to-indigo-50 rounded-xl border-2
                        ${f?"border-cyan-400 shadow-lg shadow-cyan-200/50":"border-blue-200"} 
                        overflow-hidden cursor-${O?"grabbing":"default"}
                    `,onDrop:E,onDragOver:fe,onMouseMove:ve,onMouseUp:he,onTouchMove:je,onTouchEnd:Ne,onMouseLeave:he,onClick:()=>{w(null),H(null),L(null)},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"20px 20px"}}),e.jsx("svg",{className:"absolute inset-0 w-full h-full",style:{pointerEvents:"none"},children:x.map(n=>{const i=ue(n.fromId,n.fromPort),r=ue(n.toId,n.toPort),u=X.get(n.id),v=(u==null?void 0:u.isActive)??!1,z=(u==null?void 0:u.isReverse)??!1,P=r.x-i.x;r.y-i.y;const M=25;let T;if(n.fromPort==="output"&&n.toPort==="input"){const m=i.x+Math.max(M,Math.abs(P)/2);T=`${i.x},${i.y} ${m},${i.y} ${m},${r.y} ${r.x},${r.y}`}else if(n.fromPort==="input"&&n.toPort==="output"){const m=i.x-Math.max(M,Math.abs(P)/2);T=`${i.x},${i.y} ${m},${i.y} ${m},${r.y} ${r.x},${r.y}`}else if(n.fromPort==="output"&&n.toPort==="output"){const m=Math.max(i.x,r.x)+M;T=`${i.x},${i.y} ${m},${i.y} ${m},${r.y} ${r.x},${r.y}`}else{const m=Math.min(i.x,r.x)-M;T=`${i.x},${i.y} ${m},${i.y} ${m},${r.y} ${r.x},${r.y}`}const b=T.split(" ").map(m=>{const[$,B]=m.split(",").map(Number);return{x:$,y:B}}),te=(b[1].x+b[2].x)/2,V=(b[1].y+b[2].y)/2;let h;z?h=`M${T.split(" ").reverse().join(" ").split(" ").map($=>$.replace(","," ")).join(" L ")}`:h=`M${T.split(" ").map(m=>m.replace(","," ")).join(" L ")}`;const C=q===n.id;return e.jsxs("g",{onMouseEnter:()=>L(n.id),onClick:m=>{m.stopPropagation(),L(q===n.id?null:n.id)},style:{cursor:"pointer",pointerEvents:"auto"},children:[e.jsx("polyline",{points:T,fill:"none",stroke:"transparent",strokeWidth:15,style:{pointerEvents:"stroke"}}),e.jsx("polyline",{points:T,fill:"none",stroke:C?"#ef4444":v?"#22d3ee":"#64748b",strokeWidth:C?4:3,strokeLinecap:"round",strokeLinejoin:"round",style:{pointerEvents:"none"}}),v&&!C&&e.jsx("circle",{r:"4",fill:"#22d3ee",children:e.jsx("animateMotion",{dur:"1.5s",repeatCount:"indefinite",path:h})}),C&&!o&&e.jsxs("g",{onClick:m=>{m.stopPropagation(),Se(n.id)},style:{cursor:"pointer"},children:[e.jsx("circle",{cx:te,cy:V,r:12,fill:"#ef4444",stroke:"white",strokeWidth:2}),e.jsx("text",{x:te,y:V+1,textAnchor:"middle",dominantBaseline:"middle",fill:"white",fontSize:"14",fontWeight:"bold",children:"√ó"})]})]},n.id)})}),l.map(n=>e.jsx(Ue,{component:n,isSelected:N===n.id,isConnecting:(f==null?void 0:f.id)===n.id,onClick:()=>w(n.id),onToggle:()=>Pe(n.id),onPortClick:i=>ke(n.id,i),onDragStart:i=>ye(n.id,i),onTouchStart:i=>we(n.id,i),isDragging:O===n.id},n.id)),l.length===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white/30",children:[e.jsx("p",{className:"text-lg mb-2",children:"K√©o th·∫£ linh ki·ªán v√†o ƒë√¢y"}),e.jsx("p",{className:"text-sm",children:"Nh·∫•n v√†o ƒë·∫ßu xanh/ƒë·ªè ƒë·ªÉ n·ªëi d√¢y"})]})})]})]})]})},oe={validateBasicCircuit:(s,t)=>t.isPowered&&t.isComplete,validateBulbOn:(s,t)=>{const c=s.components.find(o=>o.type==="bulb"&&o.isActive);return t.isPowered&&t.isComplete&&!!c},validateSwitchControls:(s,t)=>{const c=s.components.find(a=>a.type==="bulb"&&a.isActive),o=s.components.some(a=>a.type==="switch");return t.isPowered&&t.isComplete&&!!c&&o},validateBellWorks:(s,t)=>{const c=s.components.find(o=>o.type==="bell"&&o.isActive);return t.isPowered&&t.isComplete&&!!c},validateSeriesBulbs:(s,t)=>{const c=s.components.filter(o=>o.type==="bulb"&&o.isActive);return t.isPowered&&t.isComplete&&c.length>=2},validateParallelBulbs:(s,t)=>{const c=s.components.filter(o=>o.type==="bulb"&&o.isActive);return t.isPowered&&t.isComplete&&c.length>=2},validateFanWorks:(s,t)=>{const c=s.components.find(o=>o.type==="fan"&&o.isActive);return t.isPowered&&t.isComplete&&!!c},validateCandleBlown:(s,t)=>{const c=s.components.find(a=>a.type==="candle"&&a.isActive),o=s.components.find(a=>a.type==="fan"&&a.isActive);return t.isPowered&&!!o&&!!c},validateIndependentControl:(s,t)=>{const c=s.components.filter(a=>a.type==="bulb"),o=s.components.filter(a=>a.type==="switch");return c.length<2||o.length<2?!1:t.isPowered&&c.some(a=>a.isActive)},validateAlarmSystem:(s,t)=>{const c=s.components.find(a=>a.type==="bell"&&a.isActive),o=s.components.find(a=>a.type==="buzzer"&&a.isActive);return t.isPowered&&!!c&&!!o},validateSmartRoom:(s,t)=>{const c=s.components.find(l=>l.type==="bulb"&&l.isActive),o=s.components.find(l=>l.type==="fan"&&l.isActive),a=s.components.filter(l=>l.type==="switch");return t.isPowered&&!!c&&!!o&&a.length>=2},validateBuzzerWorks:(s,t)=>{const c=s.components.find(o=>o.type==="buzzer"&&o.isActive);return t.isPowered&&t.isComplete&&!!c},validateBulbAndBell:(s,t)=>{const c=s.components.find(a=>a.type==="bulb"&&a.isActive),o=s.components.find(a=>a.type==="bell"&&a.isActive);return t.isPowered&&!!c&&!!o},validateThreeBulbsSeries:(s,t)=>{const c=s.components.filter(o=>o.type==="bulb"&&o.isActive);return t.isPowered&&t.isComplete&&c.length>=3},validateComplexCircuit:(s,t)=>{const c=s.components.find(l=>l.type==="bulb"&&l.isActive),o=s.components.find(l=>l.type==="fan"&&l.isActive),a=s.components.find(l=>l.type==="bell"&&l.isActive);return t.isPowered&&!!c&&!!o&&!!a}},_e=({onComplete:s})=>{const[t,c]=p.useState(null),[o,a]=p.useState(!1),[l,g]=p.useState(!1),[x,k]=p.useState(!1),[N,w]=p.useState(0),[d,y]=p.useState(0),[S,Y]=p.useState(0),[X]=p.useState(new Set),R=p.useRef({components:[],wires:[]}),[I,j]=p.useState({isComplete:!1,isPowered:!1});p.useEffect(()=>{f()},[]);const f=q=>{const L=Fe();c(L),R.current={components:[],wires:[]},j({isComplete:!1,isPowered:!1}),Y(A=>A+1),a(!1),g(!1)},H=p.useCallback(q=>{R.current=q},[]),O=p.useCallback(q=>{j(q)},[]),F=()=>{if(!t)return;const q=R.current,L={};t.requiredComponents.forEach(E=>{L[E]=(L[E]||0)+1});const A={};q.components.forEach(E=>{A[E.type]=(A[E.type]||0)+1});const W=Object.entries(L).every(([E,G])=>(A[E]||0)>=G),K=(t.validator&&oe[t.validator]?oe[t.validator]:oe.validateBasicCircuit)(q,I),_=W&&K;if(console.log("Validation:",{hasAllRequired:W,requiredCounts:L,actualCounts:A,circuitStatus:I,circuitWorks:K,success:_}),g(_),a(!0),_){const E=X.has(t.id);k(E),E||(X.add(t.id),w(G=>G+1),y(G=>G+((t==null?void 0:t.difficulty)||1)),s==null||s((t==null?void 0:t.difficulty)||1))}else k(!1)},U=()=>{f()},Z=q=>e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(L=>e.jsx(xe,{size:20,className:L<=q?"text-yellow-400 fill-yellow-400":"text-gray-600"},L))});return t?e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-100 to-amber-100 rounded-lg px-3 py-2 mb-2 border border-orange-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[e.jsx("span",{className:"text-xl",children:"üéØ"}),e.jsx("h3",{className:"font-bold text-orange-800 truncate",children:t.title}),Z(t.difficulty),e.jsx("span",{className:"text-gray-600 text-sm hidden sm:inline",children:"‚Äî"}),e.jsx("p",{className:"text-gray-600 text-sm truncate hidden sm:inline",children:t.description})]}),e.jsxs("button",{onClick:()=>f(),className:"flex items-center gap-1 px-2 py-1 bg-white hover:bg-orange-50 rounded-md text-orange-600 transition-all border border-orange-200 text-sm shrink-0",children:[e.jsx(We,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:"ƒê·ªïi ƒë·ªÅ"})]})]}),t.hint&&e.jsxs("p",{className:"text-orange-600/80 text-xs mt-1 truncate",children:["üí° ",t.hint]})]}),e.jsx("div",{className:"flex-1 min-h-0",children:e.jsx(ae,{onChange:H,onCircuitStatusChange:O},S)}),e.jsxs("div",{className:"relative z-10 flex items-center justify-between mt-4 pt-4 border-t border-white/10 bg-gradient-to-t from-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-white/50 text-sm",children:["ƒê√£ ho√†n th√†nh: ",e.jsx("span",{className:"text-white font-semibold",children:N})]}),e.jsxs("div",{className:"flex items-center gap-1 text-yellow-400 text-sm",children:[e.jsx(xe,{size:16,className:"fill-yellow-400"}),e.jsx("span",{className:"font-semibold",children:d})]})]}),e.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-6 py-3 bg-green-600 hover:bg-green-500 rounded-xl text-white font-semibold transition-all",children:[e.jsx(ce,{size:20}),"Ki·ªÉm tra"]})]}),o&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:`
                        w-full max-w-md p-6 rounded-2xl text-center
                        ${l?"bg-gradient-to-br from-green-900 to-green-800 border-2 border-green-500":"bg-gradient-to-br from-red-900 to-red-800 border-2 border-red-500"}
                    `,children:[e.jsx("div",{className:"text-6xl mb-4",children:l?"üéâ":"ü§î"}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:l?"Tuy·ªát v·ªùi!":"Ch∆∞a ƒë√∫ng!"}),e.jsx("p",{className:"text-white/70 mb-4",children:l?x?"B·∫°n ƒë√£ l√†m b√†i n√†y r·ªìi n√™n kh√¥ng nh·∫≠n th√™m sao.":`B·∫°n ƒë√£ ho√†n th√†nh nhi·ªám v·ª• v√† nh·∫≠n ƒë∆∞·ª£c ${t.difficulty} sao!`:I.isPowered?"M·∫°ch ƒëang ch·∫°y nh∆∞ng ch∆∞a ƒë·ªß linh ki·ªán y√™u c·∫ßu.":'H√£y b·∫•m "B·∫≠t ngu·ªìn" ƒë·ªÉ ki·ªÉm tra m·∫°ch ho·∫°t ƒë·ªông.'}),l&&e.jsx("div",{className:"flex justify-center gap-2 mb-6",children:Z(t.difficulty)}),e.jsx("div",{className:"flex gap-3 justify-center",children:l?e.jsxs("button",{onClick:U,className:"flex items-center gap-2 px-6 py-3 bg-white text-green-700 rounded-xl font-semibold hover:bg-green-100 transition-all",children:[e.jsx(He,{size:20}),"B√†i ti·∫øp theo"]}):e.jsx("button",{onClick:()=>a(!1),className:"flex items-center gap-2 px-6 py-3 bg-white text-red-700 rounded-xl font-semibold hover:bg-red-100 transition-all",children:"Th·ª≠ l·∫°i"})})]})})]}):null},Je=s=>({2:{components:[{id:"bat1",type:"battery",x:80,y:180,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:300,y:80,rotation:0,state:"on",isActive:!1}],wires:[{id:"w1",fromId:"bat1",fromPort:"output",toId:"bulb1",toPort:"input"}]},3:{components:[{id:"bat1",type:"battery",x:100,y:150,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:300,y:150,rotation:0,state:"on",isActive:!1}],wires:[]},4:{components:[{id:"bat1",type:"battery",x:80,y:180,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:320,y:80,rotation:0,state:"on",isActive:!1},{id:"sw1",type:"switch",x:200,y:180,rotation:0,state:"off",isActive:!1}],wires:[]},5:{components:[{id:"bat1",type:"battery",x:100,y:200,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:300,y:100,rotation:0,state:"on",isActive:!1}],wires:[]},6:{components:[{id:"bat1",type:"battery",x:80,y:200,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:220,y:80,rotation:0,state:"on",isActive:!1},{id:"bulb2",type:"bulb",x:360,y:80,rotation:0,state:"on",isActive:!1},{id:"sw1",type:"switch",x:220,y:200,rotation:0,state:"off",isActive:!1}],wires:[]},7:{components:[{id:"bat1",type:"battery",x:100,y:200,rotation:0,state:"on",isActive:!1},{id:"bulb1",type:"bulb",x:280,y:80,rotation:0,state:"on",isActive:!1},{id:"bulb2",type:"bulb",x:400,y:80,rotation:0,state:"on",isActive:!1}],wires:[]}})[s]||{components:[],wires:[]},et={1:[{id:"electron-movement",text:"A. Electron di chuy·ªÉn trong d√¢y d·∫´n"},{id:"light-creation",text:"B. Pin t·∫°o ra √°nh s√°ng"},{id:"wire-electricity",text:"C. D√¢y d·∫´n t·ª± ph√°t ƒëi·ªán"}],3:[{id:"control-circuit",text:"A. ƒê√≥ng/m·ªü m·∫°ch ƒëi·ªán"},{id:"create-power",text:"B. T·∫°o ra ƒëi·ªán"},{id:"store-power",text:"C. L∆∞u tr·ªØ ƒëi·ªán"}],8:[{id:"series",text:"A. M·∫°ch n·ªëi ti·∫øp - t·∫•t c·∫£ ƒë√®n t·∫Øt c√πng nhau"},{id:"parallel",text:"B. M·∫°ch song song - c√°c ƒë√®n ho·∫°t ƒë·ªông ƒë·ªôc l·∫≠p"},{id:"no-difference",text:"C. Kh√¥ng c√≥ s·ª± kh√°c bi·ªát"}]},tt=({lessonId:s,correctAnswer:t,selectedAnswer:c,onSelectAnswer:o})=>{const a=et[s]||[];return e.jsx("div",{className:"space-y-2",children:a.map(l=>{const g=c===l.id,x=l.id===t,k=g&&x;return e.jsxs("button",{onClick:()=>o(l.id),className:`w-full p-3 rounded-lg text-left transition-all border flex items-center justify-between ${k?"bg-emerald-100 border-emerald-400 text-emerald-800":g&&!x?"bg-red-100 border-red-300 text-red-800":"bg-sky-50 hover:bg-sky-100 border-sky-200 text-sky-800"}`,children:[e.jsx("span",{children:l.text}),k&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-emerald-500 flex items-center justify-center",children:e.jsx(ce,{size:16,className:"text-white"})})]},l.id)})})},ut=()=>{const s=Be(),{currentStudent:t}=qe(),{updateStudent:c}=Ee(),[o,a]=p.useState("menu"),[l,g]=p.useState(null),[x,k]=p.useState(null),[N,w]=p.useState({isComplete:!1,isPowered:!1}),d=ne.find(j=>j.id===l);p.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const y=j=>{!t||j<=0||(c({...t,stars:t.stars+j}),console.log(`‚úÖ Added ${j} stars to profile!`))},S=()=>e.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"text-7xl mb-4 animate-bounce",children:"‚ö°"}),e.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 via-orange-400 to-pink-400",children:"ƒêi·ªán & M·∫°ch ƒëi·ªán"}),e.jsx("p",{className:"text-orange-700 mt-2 text-lg",children:"H·ªçc c√°ch l·∫Øp r√°p m·∫°ch ƒëi·ªán qua th√≠ nghi·ªám t∆∞∆°ng t√°c üîå"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("button",{onClick:()=>a("lessons"),className:"group p-6 bg-gradient-to-br from-sky-400 to-blue-500 rounded-2xl border-2 border-sky-300 hover:border-white shadow-lg shadow-blue-500/30 transition-all hover:scale-105 hover:shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white/30 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(Ke,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"üìö H·ªçc theo b√†i"}),e.jsx("p",{className:"text-white/90 text-sm",children:"8 b√†i h·ªçc t·ª´ c∆° b·∫£n ƒë·∫øn n√¢ng cao v·ªõi l√Ω thuy·∫øt v√† b√†i t·∫≠p"})]}),e.jsxs("button",{onClick:()=>a("playground"),className:"group p-6 bg-gradient-to-br from-emerald-400 to-green-500 rounded-2xl border-2 border-emerald-300 hover:border-white shadow-lg shadow-green-500/30 transition-all hover:scale-105 hover:shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white/30 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(Ye,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"üéÆ Th·ª≠ th√°ch"}),e.jsx("p",{className:"text-white/90 text-sm",children:"Ho√†n th√†nh c√°c nhi·ªám v·ª• l·∫Øp m·∫°ch v√† nh·∫≠n sao th∆∞·ªüng ‚≠ê"})]}),e.jsxs("button",{onClick:()=>a("sandbox"),className:"group p-6 bg-gradient-to-br from-violet-400 to-purple-500 rounded-2xl border-2 border-violet-300 hover:border-white shadow-lg shadow-purple-500/30 transition-all hover:scale-105 hover:shadow-xl text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto bg-white/30 rounded-xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:e.jsx(ge,{size:32,className:"text-white"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"üß™ T·ª± do"}),e.jsx("p",{className:"text-white/90 text-sm",children:"Tho·∫£i m√°i th√≠ nghi·ªám v√† s√°ng t·∫°o m·∫°ch ƒëi·ªán c·ªßa ri√™ng b·∫°n üí°"})]})]})]}),Y=()=>e.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-orange-800 mb-6",children:"üìö Danh s√°ch b√†i h·ªçc"}),e.jsx("div",{className:"space-y-3",children:ne.map(j=>e.jsxs("button",{onClick:()=>{g(j.id),k(null),w({isComplete:!1,isPowered:!1}),a("lesson-detail")},className:"w-full flex items-center gap-4 p-4 bg-white hover:bg-orange-50 rounded-xl border-2 border-orange-200 hover:border-orange-400 shadow-sm hover:shadow-md transition-all text-left",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-400 to-amber-500 rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-md",children:j.id}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-900 font-semibold",children:j.title}),e.jsx("p",{className:"text-orange-600/70 text-sm",children:j.subtitle})]}),e.jsx(be,{size:20,className:"text-orange-400 rotate-180"})]},j.id))})]}),X=()=>d?e.jsx("div",{className:"max-w-4xl mx-auto py-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center bg-white rounded-2xl p-6 shadow-md border-2 border-orange-200",children:[e.jsxs("span",{className:"text-orange-500 text-sm font-semibold",children:["üìñ B√†i ",d.id]}),e.jsx("h2",{className:"text-3xl font-bold text-orange-800 mt-1",children:d.title}),e.jsx("p",{className:"text-orange-600/80",children:d.subtitle})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border-2 border-sky-200 shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-sky-600 mb-3",children:"üìñ L√Ω thuy·∫øt"}),e.jsx("p",{className:"text-gray-700 leading-relaxed mb-4",children:d.theory.content}),e.jsx("div",{className:"space-y-2",children:d.theory.keyPoints.map((j,f)=>e.jsxs("div",{className:"flex items-start gap-2 text-gray-600",children:[e.jsx("span",{className:"text-sky-500",children:"‚Ä¢"}),j]},f))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border-2 border-emerald-200 shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-emerald-600 mb-3",children:"‚úèÔ∏è B√†i t·∫≠p"}),e.jsx("p",{className:"text-gray-700 mb-4",children:d.exercise.instruction}),(d.exercise.type==="build"||d.exercise.type==="fix")&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-[350px] bg-gradient-to-br from-sky-50 to-blue-100 rounded-xl border border-sky-200 overflow-hidden",children:e.jsx(ae,{initialCircuit:Je(d.id),hideToolbar:!0,onCircuitStatusChange:w},d.id)}),N.isPowered&&N.isComplete?e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-emerald-100 border-2 border-emerald-400 rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500 flex items-center justify-center",children:e.jsx(ce,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-emerald-800",children:"üéâ Tuy·ªát v·ªùi! M·∫°ch ho·∫°t ƒë·ªông!"}),e.jsx("p",{className:"text-emerald-600 text-sm",children:"B·∫°n ƒë√£ ho√†n th√†nh b√†i t·∫≠p n√†y"})]})]}):e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-amber-50 border-2 border-amber-300 rounded-xl",children:[e.jsx("div",{className:"text-2xl",children:"üí°"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-amber-800",children:["G·ª£i √Ω: ",N.isPowered?"B·∫≠t ngu·ªìn ƒëi·ªán ƒë·ªÉ test":"H√£y n·ªëi m·∫°ch th√†nh v√≤ng k√≠n"]}),e.jsx("p",{className:"text-amber-600 text-sm",children:"M·∫°ch c·∫ßn k√≠n v√† ngu·ªìn b·∫≠t ƒë·ªÉ ƒë√®n s√°ng"})]})]})]}),d.exercise.type==="quiz"&&e.jsx(tt,{lessonId:d.id,correctAnswer:d.exercise.correctAnswer,selectedAnswer:x,onSelectAnswer:k})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("button",{onClick:()=>{d.id>1&&(g(d.id-1),k(null),w({isComplete:!1,isPowered:!1}))},disabled:d.id===1,className:"px-4 py-2 bg-gray-200 hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-gray-700 transition-colors",children:"‚Üê B√†i tr∆∞·ªõc"}),e.jsx("button",{onClick:()=>{d.id<ne.length&&(g(d.id+1),k(null),w({isComplete:!1,isPowered:!1}))},disabled:d.id===ne.length,className:"px-4 py-2 bg-gradient-to-r from-orange-400 to-amber-500 hover:from-orange-500 hover:to-amber-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-white font-semibold shadow-md transition-colors",children:"B√†i ti·∫øp ‚Üí"})]})]})}):null,R=()=>e.jsx("div",{className:"h-[calc(100vh-120px)]",children:e.jsx("div",{className:"bg-white rounded-2xl border-2 border-orange-200 shadow-lg h-full overflow-hidden",children:e.jsx(_e,{onComplete:y})})}),I=()=>e.jsxs("div",{className:"h-[calc(100vh-120px)]",children:[e.jsx("div",{className:"text-center text-orange-700 mb-2 font-medium text-lg",children:"üß™ Ch·∫ø ƒë·ªô t·ª± do - Th·ªèa s·ª©c s√°ng t·∫°o! üí°"}),e.jsx("div",{className:"h-[calc(100%-40px)] bg-white rounded-2xl border-2 border-purple-200 shadow-lg overflow-hidden",children:e.jsx(ae,{})})]});return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-amber-100 via-orange-100 to-yellow-100 px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>o==="menu"?s("/science"):a("menu"),className:"flex items-center gap-2 px-4 py-2 bg-orange-500 hover:bg-orange-600 rounded-xl text-white shadow-md transition-colors",children:[e.jsx(be,{size:20}),e.jsx("span",{className:"hidden sm:inline",children:o==="menu"?"Khoa h·ªçc":"Menu"})]}),e.jsx("h1",{className:"text-xl font-bold text-orange-800 flex items-center gap-2",children:"‚ö° ƒêi·ªán & M·∫°ch ƒëi·ªán"}),e.jsx(De,{})]}),o==="menu"&&S(),o==="lessons"&&Y(),o==="lesson-detail"&&X(),o==="playground"&&R(),o==="sandbox"&&I()]})};export{ut as ElectricityPage};
